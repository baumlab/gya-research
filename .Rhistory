scale_x_discrete(limits = rev(levels(gender.change$level)))+
theme(axis.text.x = element_text(angle=90, vjust=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
labs(x="", y="Percentage of responses", fill="")+
scale_fill_discrete(labels=c("Fundamental", "Use-inspired", "Applied"))
myColors<-(brewer.pal(9, "Blues"))
myColors<-rev(myColors[c(9, 6, 4)])
colScale <- scale_fill_manual(name = "type",values = myColors)
#change order of levels
gender.change$level<-factor(gender.change$level, levels(gender.change$level)[c(1,3,2,6,4,5)])
gender.change$type<-factor(gender.change$type, levels(gender.change$type)[c(2,3,1)])
ggplot(data=gender.change, aes(x=level, Freq, fill=type))+
geom_bar(stat="identity", position="dodge")+
scale_x_discrete(limits = rev(levels(gender.change$level)))+
theme(axis.text.x = element_text(angle=0, vjust=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
labs(x="", y="Percentage of responses", fill="")+
scale_fill_discrete(labels=c("Fundamental", "Use-inspired", "Applied"))
ggplot(data=gender.change, aes(x=level, Freq, fill=type))+
geom_bar(stat="identity", position="dodge")+
scale_x_discrete(limits = rev(levels(gender.change$level)))+
theme(axis.text.x = element_text(angle=0, vjust=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
labs(x="", y="Percentage of responses", fill="")+
scale_fill_discrete(labels=c("Fundamental", "Use-inspired", "Applied"))  + colScale
levels(gender.change$levels)
levels(gender.change$type)
gender.change$type<-factor(gender.change$type, levels(gender.change$type)[c(3,1,2)])
gender.change$level<-factor(gender.change$level, levels(gender.change$level)[c(1,3,2,6,4,5)])
canada<-subset(part3.change, Country=="Canada")
##switch to long format
change.long.ca<-gather(canada, type, level, -Location, -gender, -Country, -Country_work)
gender.change<-with(change.long.ca, data.frame(table(type, level)))
#remove no response
dim(gender.change[!gender.change$level=="",])
## 18 no responses
gender.change<-gender.change[!gender.change$level=="",]
# turn to percents
#male<-subset(gender.change, gender=="Male")
#female<-subset(gender.change, gender=="Female")
#other<-subset(gender.change, gender=="Other")
#gender.change$Location<-ifelse(gender.change$gender=="Male", (gender.change$Location/sum(male$Location))*100, gender.change$Location)
#gender.change$Location<-ifelse(gender.change$gender=="Female", (gender.change$Location/sum(female$Location))*100, gender.change$Location)
#gender.change$Location<-ifelse(gender.change$gender=="Other", (gender.change$Location/sum(other$Location))*100, gender.change$Location)
# change type to factor with levels
gender.change$type<-as.factor(gender.change$type)
gender.change$level<-str_replace_all(gender.change$level, "Will", "")
gender.change$level<-as.factor(gender.change$level)
# add colour palette
myColors<-(brewer.pal(9, "Blues"))
myColors<-rev(myColors[c(9, 6, 4)])
colScale <- scale_fill_manual(name = "type",values = myColors, labels=c("Fundamental", "Use-inspired", "Applied"))
#change order of levels
#change order of levels
gender.change$level<-factor(gender.change$level, levels(gender.change$level)[c(1,3,2,6,4,5)])
gender.change$type<-factor(gender.change$type, levels(gender.change$type)[c(3,1,2)])
ggplot(data=gender.change, aes(x=level, Freq, fill=type))+
geom_bar(stat="identity", position="dodge")+
scale_x_discrete(limits = rev(levels(gender.change$level)))+
theme(axis.text.x = element_text(angle=0, vjust=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
labs(x="", y="Percentage of responses", fill="")+
scale_fill_discrete(labels=c("Fundamental", "Use-inspired", "Applied"))  + colScale
ggplot(data=gender.change, aes(x=level, Freq, fill=type))+
geom_bar(stat="identity", position="dodge")+
scale_x_discrete(limits = rev(levels(gender.change$level)))+
theme(axis.text.x = element_text(angle=0, vjust=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
labs(x="", y="Percentage of responses", fill="")+ colScale
```
head(gender.change)
ggplot(data=gender.change, aes(x=level, Freq, fill=type))+
geom_bar(stat="identity", position="dodge")+
scale_x_discrete(limits = rev(levels(gender.change$level)))+
theme(axis.text.x = element_text(angle=0, vjust=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
labs(x="", y="Percentage of responses", fill="")+ colScale
myColors<-(myColors[c(9, 6, 4)])
colScale <- scale_fill_manual(name = "type",values = myColors, labels=c("Fundamental", "Use-inspired", "Applied"))
gender.change$level<-factor(gender.change$level, levels(gender.change$level)[c(1,3,2,6,4,5)])
gender.change$type<-factor(gender.change$type, levels(gender.change$type)[c(3,1,2)])
ggplot(data=gender.change, aes(x=level, Freq, fill=type))+
geom_bar(stat="identity", position="dodge")+
scale_x_discrete(limits = rev(levels(gender.change$level)))+
theme(axis.text.x = element_text(angle=0, vjust=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
labs(x="", y="Percentage of responses", fill="")+ colScale
myColors<-(brewer.pal(9, "Blues"))
myColors<-(myColors[c(9, 6, 4)])
colScale <- scale_fill_manual(name = "type",values = myColors, labels=c("Fundamental", "Use-inspired", "Applied"))
#change order of levels
#change order of levels
gender.change$level<-factor(gender.change$level, levels(gender.change$level)[c(1,3,2,6,4,5)])
gender.change$type<-factor(gender.change$type, levels(gender.change$type)[c(3,1,2)])
ggplot(data=gender.change, aes(x=level, Freq, fill=type))+
geom_bar(stat="identity", position="dodge")+
scale_x_discrete(limits = rev(levels(gender.change$level)))+
theme(axis.text.x = element_text(angle=0, vjust=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
labs(x="", y="Percentage of responses", fill="")+ colScale
ggplot(data=gender.change, aes(x=level, Freq, fill=type))+
geom_bar(stat="identity", position="dodge")+
guides(fill=guide_legend(title=NULL)) +
scale_x_discrete(limits = rev(levels(gender.change$level)))+
theme(axis.text.x = element_text(angle=0, vjust=0.5),
panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
labs(x="", y="Percentage of responses", fill="")+ colScale
ggplot(data=gender.change, aes(x=level, Freq, fill=type))+
geom_bar(stat="identity", position="dodge")+
guides(fill=guide_legend(title=NULL)) +
scale_x_discrete(limits = rev(levels(gender.change$level)))+
theme(axis.text.x = element_text(angle=0, vjust=0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position=c(0.2, 0.8))+
labs(x="", y="Percentage of responses", fill="")+ colScale
ggplot(data=gender.change, aes(x=level, Freq, fill=type))+
geom_bar(stat="identity", position="dodge")+
guides(fill=guide_legend(title=NULL)) +
scale_x_discrete(limits = rev(levels(gender.change$level)))+
theme(axis.text.x = element_text(angle=0, vjust=0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position=c(0.15, 0.9))+
labs(x="", y="Percentage of responses", fill="")+ colScale
change.long.ca<-gather(canada, type, level, -Location, -gender, -Country, -Country_work)
gender.change<-with(change.long.ca, data.frame(table(type, level)))
#remove no response
dim(gender.change[!gender.change$level=="",])
## 18 no responses
gender.change<-gender.change[!gender.change$level=="",]
# turn to percents
#male<-subset(gender.change, gender=="Male")
#female<-subset(gender.change, gender=="Female")
#other<-subset(gender.change, gender=="Other")
#gender.change$Location<-ifelse(gender.change$gender=="Male", (gender.change$Location/sum(male$Location))*100, gender.change$Location)
#gender.change$Location<-ifelse(gender.change$gender=="Female", (gender.change$Location/sum(female$Location))*100, gender.change$Location)
#gender.change$Location<-ifelse(gender.change$gender=="Other", (gender.change$Location/sum(other$Location))*100, gender.change$Location)
# change type to factor with levels
gender.change$type<-as.factor(gender.change$type)
gender.change$level<-str_replace_all(gender.change$level, "Will", "")
gender.change$level<-as.factor(gender.change$level)
# add colour palette
myColors<-(brewer.pal(9, "Blues"))
myColors<-(myColors[c(9, 6, 4)])
colScale <- scale_fill_manual(name = "type",values = myColors, labels=c("Fundamental", "Use-inspired", "Applied"))
levels(gender.change$level)
gender.change$level<-factor(gender.change$level, levels(gender.change$level)[c(1,3,2,6,4,5)])
gender.change$type<-factor(gender.change$type, levels(gender.change$type)[c(3,1,2)])
ggplot(data=gender.change, aes(x=level, Freq, fill=type))+
geom_bar(stat="identity", position="dodge")+
guides(fill=guide_legend(title=NULL)) +
scale_x_discrete(limits = rev(levels(gender.change$level)))+
theme(axis.text.x = element_text(angle=0, vjust=0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position=c(0.15, 0.9))+
labs(x="", y="Percentage of responses", fill="")+ colScale
important<-subset(part4, select=c("Location","Country", "gender","opinion_fundamental_important"))
canada<-subset(important, Country=="Canada")
## using table to count cases of each category
sum.important<-data.frame(table(canada$opinion_fundamental_important, canada$gender))
# remove non-responses
sum.important<-sum.important[!sum.important$Var2=="",]
sum.important<-sum.important[!sum.important$Var1=="",]
head(sum.important)
perceive<-aggregate(Freq~Var1, sum.important, sum)
ggplot(data=perceive, aes(x=Var1, y=Freq)) + geom_bar(stat='identity', position='dodge')+ labs(x="", y="No. of responses", fill="")+theme(axis.text.x = element_text(angle=45, vjust=0.4))+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+scale_x_discrete(limits = rev(levels(perceive$Var1)))+geom_text(aes(label=Freq), vjust=-0.5)
```
```{r, echo=FALSE, fig.cap="Perceived change in research priority by Canadian government \n need to elabrate here but waiting to see if significant tests for gender, career, and stage return anything"}
ggplot(data=perceive, aes(x=Var1, y=Freq)) + geom_bar(stat='identity', position='dodge')+ labs(x="", y="No. of responses", fill="")+theme(axis.text.x = element_text(angle=45, vjust=0.4))+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+scale_x_discrete(limits = rev(levels(perceive$Var1)))+geom_text(aes(label=Freq), vjust=-0.5)
myColors<-(brewer.pal(9, "Blues"))
myColors<-(myColors[c(9, 7, 6, 4, 2)])
colScale <- scale_fill_manual(name = "Var1",values = myColors)
#gender.perceive<-aggregate(Freq ~ Var2 + Var1, sum.important, sum)
# turn to percents
#male<-subset(gender.perceive, Var2=="Male")
#female<-subset(gender.perceive, Var2=="Female")
#other<-subset(gender.perceive, Var2=="Other")
#gender.perceive$Freq<-ifelse(gender.perceive$Var2=='Male',(gender.perceive$Freq/sum(male$Freq))*100, gender.perceive$Freq)
#gender.perceive$Freq<-ifelse(gender.perceive$Var2=='Female',(gender.perceive$Freq/sum(female$Freq))*100, gender.perceive$Freq)
#gender.perceive$Freq<-ifelse(gender.perceive$Var2=='Other',(gender.perceive$Freq/sum(other$Freq))*100, gender.perceive$Freq)
ggplot(data=perceive, aes(x=Var1, y=Freq)) +
geom_bar(stat='identity', position='dodge')+
labs(x="", y="No. of responses", fill="")+
geom_text(aes(label=Freq), vjust=-0.5)
theme(axis.text.x = element_text(angle=0, vjust=0.4),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
scale_x_discrete(limits = rev(levels(perceive$Var1)))+ colScale
```
ggplot(data=perceive, aes(x=Var1, y=Freq)) +
geom_bar(stat='identity', position='dodge')+
labs(x="", y="No. of responses", fill="")+
geom_text(aes(label=Freq), vjust=-0.5)
theme(axis.text.x = element_text(angle=0, vjust=0.4),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_x_discrete(limits = rev(levels(perceive$Var1)))+ colScale
ggplot(data=perceive, aes(x=Var1, y=Freq)) +
geom_bar(stat='identity', position='dodge')+
labs(x="", y="No. of responses", fill="")+
geom_text(aes(label=Freq), vjust=-0.5) +
theme(axis.text.x = element_text(angle=0, vjust=0.4),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_x_discrete(limits = rev(levels(perceive$Var1)))+ colScale
myColors<-(brewer.pal(9, "Blues"))
myColors<-(myColors[c(9, 7, 6, 4, 2)])
colScale <- scale_fill_manual(name = "Var1",values = myColors)
ggplot(data=perceive, aes(x=Var1, y=Freq)) +
geom_bar(stat='identity', position='dodge')+
labs(x="", y="No. of responses", fill="")+
geom_text(aes(label=Freq), vjust=-0.5) +
theme(axis.text.x = element_text(angle=0, vjust=0.4),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_x_discrete(limits = rev(levels(perceive$Var1)))+ colScale
```
ggplot(data=perceive, aes(x=Var1, y=Freq, fill=Var1)) +
geom_bar(stat='identity', position='dodge')+
labs(x="", y="No. of responses", fill="")+
geom_text(aes(label=Freq), vjust=-0.5) +
theme(axis.text.x = element_text(angle=0, vjust=0.4),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_x_discrete(limits = rev(levels(perceive$Var1)))+ colScale
ggplot(data=perceive, aes(x=Var1, y=Freq, fill=myColors[1])) +
geom_bar(stat='identity', position='dodge')+
labs(x="", y="No. of responses", fill="")+
theme(axis.text.x = element_text(angle=0, vjust=0.4),
geom_text(aes(label=Freq), vjust=-0.5) +
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_x_discrete(limits = rev(levels(perceive$Var1)))+ colScale
ggplot(data=perceive, aes(x=Var1, y=Freq), fill=myColors[1])) +
geom_bar(stat='identity', position='dodge')+
labs(x="", y="No. of responses", fill="")+
geom_text(aes(label=Freq), vjust=-0.5) +
theme(axis.text.x = element_text(angle=0, vjust=0.4),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_x_discrete(limits = rev(levels(perceive$Var1)))+ colScale
myColors[1]
ggplot(data=perceive, aes(x=Var1, y=Freq), fill=myColors[1])) +
geom_bar(stat='identity', position='dodge')+
labs(x="", y="No. of responses", fill="")+
geom_text(aes(label=Freq), vjust=-0.5) +
theme(axis.text.x = element_text(angle=0, vjust=0.4),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_x_discrete(limits = rev(levels(perceive$Var1)))#+ colScale
ggplot(data=perceive, aes(x=Var1, y=Freq), fill=myColors[1])) +
ggplot(data=perceive, aes(x=Var1, y=Freq), fill=myColors[1]) +
geom_bar(stat='identity', position='dodge')+
labs(x="", y="No. of responses", fill="")+
theme(axis.text.x = element_text(angle=0, vjust=0.4),
geom_text(aes(label=Freq), vjust=-0.5) +
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_x_discrete(limits = rev(levels(perceive$Var1)))#+ colScale
ggplot(data=perceive, aes(x=Var1, y=Freq), fill=myColors[1]) +
geom_bar(stat='identity', position='dodge')+
labs(x="", y="No. of responses", fill="")+
geom_text(aes(label=Freq), vjust=-0.5) +
theme(axis.text.x = element_text(angle=0, vjust=0.4),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_x_discrete(limits = rev(levels(perceive$Var1)))#+ colScale
ggplot(data=perceive, aes(x=Var1, y=Freq)) +
geom_bar(stat='identity', position='dodge',fill=myColors[1])+
labs(x="", y="No. of responses", fill="")+
geom_text(aes(label=Freq), vjust=-0.5) +
theme(axis.text.x = element_text(angle=0, vjust=0.4),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_x_discrete(limits = rev(levels(perceive$Var1)))#+ colScale
ggplot(data=perceive, aes(x=Var1, y=Freq)) +
geom_bar(stat='identity', position='dodge',fill=myColors[2])+
labs(x="", y="No. of responses", fill="")+
geom_text(aes(label=Freq), vjust=-0.5) +
theme(axis.text.x = element_text(angle=0, vjust=0.4),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_x_discrete(limits = rev(levels(perceive$Var1)))#+ colScale
priority<-subset(part4, select=c("Location","Country", "gender", "high_priority_fundamental", "high_priority_use_inspired", "high_priority_applied",
"high_priority_no_change"))
canada<-subset(priority, Country=="Canada")
## switch to long format
require(tidyr)
priority.long<-gather(canada, what.type, higher.priority, -Location, -gender, -Country)
# remove non-responses
priority.long<-priority.long[!priority.long$gender=="",]
head(priority.long)
priority<-subset(part4, select=c("Location","Country", "gender", "high_priority_fundamental", "high_priority_use_inspired", "high_priority_applied",
"high_priority_no_change"))
canada<-subset(priority, Country=="Canada")
## switch to long format
priority.long<-gather(canada, what.type, higher.priority, -Location, -gender, -Country)
# remove non-responses
priority.long<-priority.long[!priority.long$gender=="",]
per.change<-aggregate(higher.priority~what.type, priority.long, sum)
head(per.change)
head(priority.long)
priority.long<-gather(canada, what.type, higher.priority, -Location, -gender, -Country)
# remove non-responses
dim(priority.long[!priority.long$gender=="",])
dim(priority.long[!priority.long$higher.priority=="",])
dim(priority.long)
dim(priority.long)/3
unique(priority.long$what.type)
dim(priority.long)/4
dim(priority.long[!priority.long$higher.priority=="",])/4
priority.long<-priority.long[!priority.long$higher.priority=="",]
per.change<-aggregate(higher.priority~what.type, priority.long, sum)
head(per.change)
per.change$what.type<-as.factor(per.change$what.type)
per.change$what.type<-factor(per.change$what.type, levels(per.change$what.type)[c(2,4,1,3)])
ggplot(data=per.change, aes(x=what.type, higher.priority))+geom_bar(stat="identity", position='dodge')+ theme(axis.text.x = element_text()) +labs(x="", y="No. of responses", fill="") +theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+ scale_x_discrete(labels=c( "Fundamental", "Use-inspired","Applied", "No change"))+theme(axis.text.x = element_text(angle=45, vjust=0.4))+geom_text(aes(label=higher.priority), vjust=-0.5)
```
```{r, echo=FALSE, fig.cap="Anticipated change in research funding in next 5 years in Canada \n need to elabrate here but waiting to see if significant tests for gender, career, and stage return anything "}
head(per.change)
ggplot(data=per.change, aes(x=what.type, higher.priority))+
geom_bar(stat="identity", position='dodge')+
theme(axis.text.x = element_text(),
axis.text.x = element_text(angle=45, vjust=0.4),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
labs(x="", y="No. of responses", fill="") +
scale_x_discrete(labels=c( "Fundamental", "Use-inspired","Applied", "No change"))   +
geom_text(aes(label=higher.priority), vjust=-0.5)
head(per.change)
ggplot(data=per.change, aes(x=what.type, higher.priority))+
geom_bar(stat="identity", position='dodge', fill=MyColors[2])+
theme(axis.text.x = element_text(),
axis.text.x = element_text(angle=45, vjust=0.4),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
labs(x="", y="No. of responses", fill="") +
scale_x_discrete(labels=c( "Fundamental", "Use-inspired","Applied", "No change"))   +
geom_text(aes(label=higher.priority), vjust=-0.5)
ggplot(data=per.change, aes(x=what.type, higher.priority))+
geom_bar(stat="identity", position='dodge', fill=myColors[2])+
theme(axis.text.x = element_text(),
axis.text.x = element_text(angle=45, vjust=0.4),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
labs(x="", y="No. of responses", fill="") +
scale_x_discrete(labels=c( "Fundamental", "Use-inspired","Applied", "No change"))   +
geom_text(aes(label=higher.priority), vjust=-0.5)
```
next.generation<-subset(part4, select=c("Location", "Country", "gender","next_generation"))
next.generation<-next.generation[!next.generation$next_generation=="",]
canada<-subset(next.generation, Country=="Canada")
head(canada)
impact<-data.frame(table(canada$next_generation))
impact$next_generation<-str_replace_all(impact$next_generation, "Will ", "")
impact$Var1<-str_replace_all(impact$Var1, "Will ", "")
impact$Var1<-as.factor(impact$Var1)
## change order of Var1s
impact$Var1<-factor(impact$Var1, factor(impact$Var1)[c(2,3,6,5,4,1 )])
ggplot(data=impact, aes(x=Var1, freq1, fill=Var1))+ geom_bar(stat='identity', position="dodge") + scale_x_discrete(labels=c("Decrease Considerably","Decrease Slightly","Stay the Same","Increase Slightly","Increase Considerably", "Can't Comment")) + guides(fill=FALSE) +
labs(x="", y="No. of responses")+theme(axis.text.x = element_text(angle=45, vjust=0.5))+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+geom_text(aes(label=gender), vjust=-0.5)
```
ggplot(data=impact, aes(x=Var1, freq, fill=Var1))+ geom_bar(stat='identity', position="dodge") + scale_x_discrete(labels=c("Decrease Considerably","Decrease Slightly","Stay the Same","Increase Slightly","Increase Considerably", "Can't Comment")) + guides(fill=FALSE) +
labs(x="", y="No. of responses")+theme(axis.text.x = element_text(angle=45, vjust=0.5))+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+geom_text(aes(label=gender), vjust=-0.5)
```
ggplot(data=impact, aes(x=Var1, Freq, fill=Var1))+ geom_bar(stat='identity', position="dodge") + scale_x_discrete(labels=c("Decrease Considerably","Decrease Slightly","Stay the Same","Increase Slightly","Increase Considerably", "Can't Comment")) + guides(fill=FALSE) +
labs(x="", y="No. of responses")+theme(axis.text.x = element_text(angle=45, vjust=0.5))+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+geom_text(aes(label=gender), vjust=-0.5)
ggplot(data=impact, aes(x=Var1, Freq, fill=Var1))+
geom_bar(stat='identity', position="dodge") +
scale_x_discrete(labels=c("Decrease considerably","Decrease slightly","Stay the same","Increase slightly","Increase considerably", "Can't comment")) +
guides(fill=FALSE) +
labs(x="", y="No. of responses")+
theme(axis.text.x = element_text(angle=45, vjust=0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
geom_text(aes(label=gender), vjust=-0.5)
head(impact)
impact<-impact[!impact$Var1=="0",]
ggplot(data=impact, aes(x=Var1, Freq, fill=Var1))+
geom_bar(stat='identity', position="dodge") +
scale_x_discrete(labels=c("Decrease considerably","Decrease slightly","Stay the same","Increase slightly","Increase considerably", "Can't comment")) +
guides(fill=FALSE) +
labs(x="", y="No. of responses")+
theme(axis.text.x = element_text(angle=45, vjust=0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
geom_text(aes(label=gender), vjust=-0.5)
ggplot(data=impact, aes(x=Var1, Freq, fill=Var1))+
geom_bar(stat='identity', position="dodge") +
# scale_x_discrete(labels=c("Decrease considerably","Decrease slightly","Stay the same","Increase slightly","Increase considerably", "Can't comment")) +
guides(fill=FALSE) +
labs(x="", y="No. of responses")+
theme(axis.text.x = element_text(angle=45, vjust=0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
geom_text(aes(label=gender), vjust=-0.5)
ggplot(data=impact, aes(x=Var1, Freq, fill=Var1))+
geom_bar(stat='identity', position="dodge")
impact<-droplevels(impact)
ggplot(data=impact, aes(x=Var1, Freq, fill=Var1))+
geom_bar(stat='identity', position="dodge")  +
scale_x_discrete(labels=c("Decrease considerably","Decrease slightly","Stay the same","Increase slightly","Increase considerably", "Can't comment")) +
guides(fill=FALSE) +
labs(x="", y="No. of responses")+
theme(axis.text.x = element_text(angle=45, vjust=0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
geom_text(aes(label=gender), vjust=-0.5)
ggplot(data=impact, aes(x=Var1, Freq))+
geom_bar(stat='identity', position="dodge", fill=myColors[2])  +
scale_x_discrete(labels=c("Decrease considerably","Decrease slightly","Stay the same","Increase slightly","Increase considerably", "Can't comment")) +
guides(fill=FALSE) +
labs(x="", y="No. of responses")+
theme(axis.text.x = element_text(angle=45, vjust=0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
geom_text(aes(label=gender), vjust=-0.5)
impact<-data.frame(table(canada$next_generation))
## change type to factor with levels
impact$Var1<-str_replace_all(impact$Var1, "Will ", "")
impact$Var1<-as.factor(impact$Var1)
impact$Var1<-factor(impact$Var1, levels(impact$Var1)[c(2,3,6,5,4,1 )])
impact<-impact[!impact$Var1=="0",]
impact<-droplevels(impact)
ggplot(data=impact, aes(x=Var1, Freq))+
geom_bar(stat='identity', position="dodge", fill=myColors[2])  +
scale_x_discrete(labels=c("Decrease considerably","Decrease slightly","Stay the same","Increase slightly","Increase considerably", "Can't comment")) +
guides(fill=FALSE) +
labs(x="", y="No. of responses")+
theme(axis.text.x = element_text(angle=45, vjust=0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
geom_text(aes(label=gender), vjust=-0.5)
levels(impact$Var1)
impact<-impact[!impact$Var1=="",]
impact<-droplevels(impact)
levels(impact$Var1)
impact<-data.frame(table(canada$next_generation))
## change type to factor with levels
impact$Var1<-str_replace_all(impact$Var1, "Will ", "")
impact$Var1<-as.factor(impact$Var1)
levels(impact$Var1)
impact<-impact[!impact$Var1=="",]
impact<-droplevels(impact)
levels(impact$Var1)
impact$Var1<-factor(impact$Var1, levels(impact$Var1)[c(4,5,6,3,2,1)])
impact<-droplevels(impact)
ggplot(data=impact, aes(x=Var1, Freq))+
geom_bar(stat='identity', position="dodge", fill=myColors[2])  +
scale_x_discrete(labels=c("Decrease considerably","Decrease slightly","Stay the same","Increase slightly","Increase considerably", "Can't comment")) +
guides(fill=FALSE) +
labs(x="", y="No. of responses")+
theme(axis.text.x = element_text(angle=45, vjust=0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
geom_text(aes(label=gender), vjust=-0.5)
ggplot(data=impact, aes(x=Var1, Freq))+
geom_bar(stat='identity', position="dodge", fill=myColors[2])
scale_x_discrete(labels=c("Increase considerably","Increase slightly","Stay the same","Decrease slightly""Decrease considerably", "Can't comment")) +
ggplot(data=impact, aes(x=Var1, Freq))+
geom_bar(stat='identity', position="dodge", fill=myColors[2])  +
scale_x_discrete(labels=c("Increase considerably","Increase slightly","Stay the same","Decrease slightly""Decrease considerably", "Can't comment")) +
guides(fill=FALSE) +
labs(x="", y="No. of responses")+
ggplot(data=impact, aes(x=Var1, Freq))+
geom_bar(stat='identity', position="dodge", fill=myColors[2])  +
scale_x_discrete(labels=c("Increase considerably","Increase slightly","Stay the same","Decrease slightly","Decrease considerably", "Can't comment")) +
guides(fill=FALSE) +
labs(x="", y="No. of responses")+
theme(axis.text.x = element_text(angle=45, vjust=0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
geom_text(aes(label=gender), vjust=-0.5)
ggplot(data=impact, aes(x=Var1, Freq))+
geom_bar(stat='identity', position="dodge", fill=myColors[2])  +
scale_x_discrete(labels=c("Increase considerably","Increase slightly","Stay the same","Decrease slightly","Decrease considerably", "Can't comment")) +
guides(fill=FALSE) +
labs(x="", y="No. of responses")+
theme(axis.text.x = element_text(angle=45, vjust=0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
geom_text(aes(label=gender), vjust=-0.5)
ggplot(data=impact, aes(x=Var1, Freq))+
geom_bar(stat='identity', position="dodge", fill=myColors[2])  +
scale_x_discrete(labels=c("Increase considerably","Increase slightly","Stay the same","Decrease slightly","Decrease considerably", "Can't comment")) +
guides(fill=FALSE) +
labs(x="", y="No. of responses")+
theme(axis.text.x = element_text(angle=45, vjust=0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
geom_text(aes(label=gender), vjust=-0.5)
ggplot(data=impact, aes(x=Var1, Freq))+
geom_bar(stat='identity', position="dodge", fill=myColors[2])  +
scale_x_discrete(labels=c("Increase considerably","Increase slightly","Stay the same","Decrease slightly","Decrease considerably", "Can't comment")) +
guides(fill=FALSE) +
labs(x="", y="No. of responses")+
theme(axis.text.x = element_text(angle=45, vjust=0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
geom_text(aes(label=Freq), vjust=-0.5)
```
ggplot(data=impact, aes(x=Var1, Freq))+
geom_bar(stat='identity', position="dodge", fill=myColors[2])  +
scale_x_discrete(labels=c("Increase considerably","Increase slightly","Stay the same","Decrease slightly","Decrease considerably", "Can't comment")) +
guides(fill=FALSE) +
labs(x="", y="No. of responses")+
theme(axis.text.x = element_text(angle=0, vjust=0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
geom_text(aes(label=Freq), vjust=-0.5)
