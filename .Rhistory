canada.yesno<-canada.yesno[!canada.yesno$Var1=="",]
canada.yesno$Var1<-revalue(canada.yesno$Var1, c("Can't comment (new researcher)"="Can't comment"))
canada.yesno$Var1<-factor(canada.yesno$Var1, levels=c("Yes", "No", "Can't comment"))
myColors<-(brewer.pal(9, "Blues"))
myColors<-myColors[c(9, 7,5)]
colScale <- scale_fill_manual(name = "Var1",values = myColors)
g1<-ggplot(data=canada.yesno, aes(x=Var1, y=Freq, fill=Var1))+
geom_bar(stat='identity') +
guides(fill=FALSE) +
labs(x="", y="No. of responses",title="")+
annotate('text', 3.25,520, label="(a)", size=7)+
geom_text(aes(label=Freq), vjust=-0.5)+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) + colScale
## GRAPH PART 2
# What is your main reason for change?
reason<-subset(research.change, select=c("Location","Country",  "gender", "Main_reason_change_interest_related",
"Main_reason_change_Career_related", "Main_reason_change_Funding_related","Main_reason_change_Socially_related",
"Main_reason_change_Other"))
canada<-subset(reason, Country=="Canada")
## switch to long format
canada.long<-gather(canada, reason.change.ca, yes.ca, -Location, -gender, -Country)
## using table to count cases of each category
sum.canada<-data.frame(table(canada.long$reason.change.ca, canada.long$yes.ca))
sum.canada$Var1<-revalue(sum.canada$Var1, c("Main_reason_change_Career_related" = "Career", "Main_reason_change_Funding_related" = "Funding", "Main_reason_change_interest_related" = "Interest", "Main_reason_change_Other" = "Other", "Main_reason_change_Socially_related"  = "Social"))
sum.canada$Var1<-reorder(sum.canada$Var1, -sum.canada$Freq)
myColors<-(brewer.pal(9, "Blues"))
myColors<-myColors[c(9, 8,7,6,5)]
colScale <- scale_fill_manual(name = "Var1",values = myColors)
g2<-ggplot(sum.canada, aes(x=Var1, y=Freq, fill=Var1)) +
geom_bar(stat='identity')+  guides(fill=FALSE) +
theme(axis.text.x = element_text(angle=0, vjust=0.5),
legend.position=c(0.8, 0.8),
legend.title=element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
annotate('text', 5,350, label="(b)", size=7)+ ylim(c(0, 350))+
geom_text(aes(label=Freq), vjust=-0.5)+
labs(x="", y="", title="")+
colScale
grid.arrange(g1, g2, nrow=1)
```
```{r, echo=FALSE, fig.cap="Opinion of change in research over past 10 years"}
canada<-subset(part1.view, Country=="Canada")
canada<-canada[!canada$view_change_of_type=="",]
change.view.ca<-data.frame(table(canada$view_change_of_type))
change.view.ca<-change.view.ca[!change.view.ca$Var1=="",]
change.view.ca$Var1<-droplevels(change.view.ca$Var1)
# change order of the levels
change.view.ca$Var1<-factor(change.view.ca$Var1,
levels(change.view.ca$Var1)[c(5,3,1,2,4)])
myColors<-(brewer.pal(9, "Blues"))
myColors<-rev(myColors[c(7,7,7,7,7)])
colScale <- scale_fill_manual(name = "Var1",values = myColors)
ggplot(change.view.ca, aes(x=Var1, y=Freq, fill=Var1)) + geom_bar(stat='identity')+
geom_text(aes(label=Freq, vjust=-0.5))+
guides(fill=FALSE)+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle=0, vjust=0.5)) +
labs(x="", y="No. of Responses") + colScale
```
#### Part 2 - External Partnerships
```{r, echo=FALSE, fig.cap="Current vs past level of partnership outside of academia", warning=FALSE}
b.part<-data.frame(table(part2.b.a$partnership_outside_before))
b.part$time<-"Past"
a.part<-data.frame(table(part2.b.a$partnership_outside))
a.part$time<-"Current"
part<-rbind(a.part, b.part)
part$Var1<-factor(part$Var1, levels(part$Var1)[c(1,4,3,2)])
part$time<-factor(part$time)
part$time<-factor(part$time, levels(part$time)[c(2,1)])
myColors<-(brewer.pal(9, "Blues"))
myColors<-rev(myColors[c(9, 6)])
colScale <- scale_fill_manual(name = "Var1",values = myColors)
ggplot(part, aes(x=Var1, y=Freq, fill = time)) +
geom_bar( stat='identity', position="dodge") +
geom_text(aes(label=Freq), position=position_dodge(width=1), vjust=-0.8) +
labs(x="", y="No. of Responses", fill="")+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle=0),
legend.position=c(0.9, 0.9),
legend.title=element_blank()) +
colScale
```
```{r, echo=FALSE, fig.cap="Reason for change over the past 10 years", warning=FALSE}
### was there change
canada<-subset(part2.change, Country=="Canada")
change.part.ca<-data.frame(table(canada$partnership_change_10yrs))
change.part.ca$Var1<-revalue(change.part.ca$Var1, c("Can't comment (new researcher)"="Can't comment"))
change.part.ca$Var1<-factor(change.part.ca$Var1, levels=c("Yes", "No", "Can't comment"))
myColors<-(brewer.pal(9, "Blues"))
myColors<-myColors[c(9, 7,5)]
g1<-ggplot(data=change.part.ca, aes(x=Var1, y=Freq, fill=Var1))+
geom_bar(stat='identity') +
guides(fill=FALSE) +
labs(x="", y="No. of responses",title="")+
geom_text(aes(label=Freq), vjust=-0.5)+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_fill_manual(name = "Var1",values = myColors) +
annotate('text', 3.25,500, label="(a)", size=7)
### reason
reason.pt.long<-gather(part2.reason, change.reason, yes, -Country,-Country_work, -gender, -Location)
sum.canada<-data.frame(table(reason.pt.long$change.reason, reason.pt.long$yes))
sum.canada$Var1<-revalue(sum.canada$Var1, c("reason_partnership_change_career" = "Career", "reason_partnership_change_funding" = "Funding", "reason_partnership_change_interest" = "Interest", "reason_partnership_change_other" = "Other", "reason_partnership_change_socially"  = "Social"))
sum.canada$Var1<-reorder(sum.canada$Var1, -sum.canada$Freq)
myColors<-(brewer.pal(9, "Blues"))
myColors<-myColors[c(9, 8,7,6,5,3)]
g2<-ggplot(sum.canada, aes(x=Var1, y=Freq, fill=Var1)) +
geom_bar(stat='identity')+  guides(fill=FALSE) +
theme(axis.text.x = element_text(angle=0, vjust=0.5),
legend.position=c(0.8, 0.8),
legend.title=element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
geom_text(aes(label=Freq), vjust=-0.5)+
annotate('text', 5,630, label="(b)", size=7)+ ylim(c(0, 630))+
labs(x="", y="", title="")+scale_fill_manual(name = "Var1",values = myColors)
grid.arrange(g1, g2, nrow=1)
```
```{r, echo=FALSE, fig.cap="View of Change in partnership", warning=FALSE}
canada<-subset(part2.view, Country=="Canada")
view<-data.frame(table(canada$view_change_partnership))
# change order of the levels
view$Var1<-factor(view$Var1, levels(view$Var1)[c(5,3,1,2,4)])
ggplot(view, aes(x=Var1, y=Freq, fill=myColors[1])) + geom_bar(stat='identity')+
geom_text(aes(label=Freq, vjust=-1))+
guides(fill=FALSE)+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle=0, vjust=0.5)) +
labs(x="", y="No. of Responses") + colScale
```
#### Part 3 - Grant Application History
```{r, echo=FALSE, fig.cap="Number of external research grant applications", warning=FALSE, fig.height=12}
canada<-subset(part3.grants.long, Country=="Canada")
canada$type.grant<-as.character(canada$type.grant)
#add time variable
canada$time<-ifelse(grepl("11_15", canada$type.grant), "2011-2015", "2006-2010")
canada$type.grant[canada$type.grant=="external_pi_grant_11_15_fundamental"]<-"Fundamental"
canada$type.grant[canada$type.grant=="external_pi_grant_6_10_fundamental"]<-"Fundamental"
canada$type.grant[canada$type.grant=="external_pi_grant_11_15_use"]<-"Use-Inspired"
canada$type.grant[canada$type.grant=="external_pi_grant_6_10_use"]<-"Use-Inspired"
canada$type.grant[canada$type.grant=="external_pi_grant_11_15_applied"]<-"Applied"
canada$type.grant[canada$type.grant=="external_pi_grant_6_10_applied"]<-"Applied"
grants.ca<-data.frame(with(canada, table(type.grant,time,number)))
grants.ca$type.grant<-as.factor(grants.ca$type.grant)
#change order of levels
grants.ca$number<-factor(grants.ca$number, levels(grants.ca$number)[c(1,2,6,7,3,4,5)])
grants.ca$type.grant<-factor(grants.ca$type.grant, levels(grants.ca$type.grant)[c(2,3,1)])
myColors<-(brewer.pal(9, "Blues"))
myColors<-rev(myColors[c(9, 5)])
colScale <- scale_fill_manual(name = "time",values = myColors)
ggplot(grants.ca, aes(number, Freq, fill=time)) +
geom_bar(stat="identity", position = "dodge")+
facet_wrap(~type.grant, nrow=3) +
guides(fill=guide_legend(title=NULL, reverse=FALSE)) +
labs(x="No. of grant applications", y="No. of responses")+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.text.y = element_text(size=12, face="bold", color="black"),
strip.background = element_rect(colour="white", fill="white"),
legend.position=c(0.8, 0.2)) + colScale
```
```{r, echo=FALSE, fig.cap="Percentage of research grant application success", warning=FALSE}
canada<-subset(part3.success.long, Country=="Canada")
canada$type<-as.character(canada$type)
#add time variable
#canada$time<-ifelse(grepl("11_15", canada$type), "2011-2015", "2006-2010")
canada$type[canada$type=="successful_grants_11_15_fundamental"]<-"Fundamental"
canada$type[canada$type=="successful_grants_6_10_fundamental"]<-"Fundamental"
canada$type[canada$type=="successful_grants_11_15_use"]<-"Use-Inspired"
canada$type[canada$type=="successful_grants_6_10_use"]<-"Use-Inspired"
canada$type[canada$type=="successful_grants_11_15_applied"]<-"Applied"
canada$type[canada$type=="successful_grants_6_10_applied"]<-"Applied"
success.ca<-data.frame(with(canada, table(type, percent,time)))
#change order of types
success.ca$type<-as.factor(success.ca$type)
success.ca$type<-factor(success.ca$type, levels(success.ca$type)[c(2,3,1)])
myColors<-(brewer.pal(9, "Blues"))
myColors<-rev(myColors[c(9, 5)])
colScale <- scale_fill_manual(name = "time",values = myColors)
ggplot(success.ca, aes(percent, Freq, fill=time)) +
geom_bar(stat="identity", position = "dodge")+
facet_wrap(~type, nrow=3) +
guides(fill=guide_legend(title=NULL, reverse=FALSE)) +
labs(x="% successful grants", y="No. of responses")+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.text.y = element_text(size=14, face="bold", color="black"),
strip.background = element_rect(colour="white", fill="white"),
legend.position=c(0.8, 0.2)) + colScale
```
```{r, echo=FALSE, fig.cap="Importance of suggesting practical applications of the research for the grant to be successful", warning=FALSE}
canada<-subset(part3.prac.long, Country=="Canada")
canada$year<-as.character(canada$year)
canada$year[canada$year=="practical_applications_important_11_15"]<-"2011-2015"
canada$year[canada$year=="practical_applications_important_6_10"]<-"2006-2010"
prac.ca<-data.frame(table(canada$year, canada$level))
#change order of levels
prac.ca$Var2<-factor(prac.ca$Var2, levels(prac.ca$Var2)[c(2,6,4,5,3,1)])
myColors<-(brewer.pal(9, "Blues"))
myColors<-rev(myColors[c(9, 5)])
colScale <- scale_fill_manual(name = "Var1",values = myColors)
ggplot(prac.ca, aes(Var2, Freq, fill=Var1)) +
geom_bar(stat="identity", position = "dodge")+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position=c(0.8, 0.8),
axis.text.x = element_text(angle=0, vjust=0.5)) +
guides(fill=guide_legend(title=NULL, reverse=FALSE)) +
labs(x="", y="No. of responses")+ colScale
```
```{r, echo=FALSE, fig.cap="Importance of including partners from for-profit or non-governmental sectors in grant success", warning=FALSE}
canada<-subset(part3.part.long, Country=="Canada")
canada$year<-as.character(canada$year)
canada$year[canada$year=="practical_applications_important_11_15"]<-"2011-2015"
canada$year[canada$year=="practical_applications_important_6_10"]<-"2006-2010"
part.ca<-data.frame(table(canada$year, canada$level))
#change order of levels
part.ca$Var2<-factor(part.ca$Var2, levels(part.ca$Var2)[c(2,5,6,4,3,1)])
## add colour scale
myColors<-(brewer.pal(9, "Blues"))
myColors<-rev(myColors[c(9, 5)])
colScale <- scale_fill_manual(name = "Var1",values = myColors)
ggplot(part.ca, aes(Var2, Freq, fill=Var1))+
geom_bar(stat="identity", position = "dodge")+
guides(fill=guide_legend(title=NULL, reverse=FALSE)) +
labs(x="", y="No. of responses")+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position=c(0.8, 0.8)) + colScale
```
```{r, echo=FALSE, fig.cap="Distribution of research funding", warning=FALSE}
canada<-subset(p3_master.long, Country=="Canada")
canada$year<-revalue(c("11_15"="2011-2015", "6_10"="2006-2010"))
myColors<-(brewer.pal(9, "Blues"))
myColors<-rev(myColors[c(9, 5)])
colScale <- scale_fill_manual(name = "year",values = myColors)
ggplot(canada, aes(percent, fill=year))+ geom_histogram(position='dodge', binwidth=25)  +
facet_wrap(~type, nrow=5) + colScale +
guides(fill=guide_legend(title=NULL)) +
theme(legend.position=c(0.8, 0.1),
strip.text.y = element_text(size=14, face="bold", color="black"),
strip.background = element_rect(colour="white", fill="white")) +
labs(x="% research funding", y = "Frequency")
```
```{r, echo=FALSE, fig.cap="Grant success rates change over the past 10 years", warning=FALSE}
canada<-subset(part3.change, Country=="Canada")
##switch to long format
change.long.ca<-gather(canada, type, level, -Location, -gender, -Country, -Country_work)
gender.change<-with(change.long.ca, data.frame(table(type, level)))
#remove no response
dim(gender.change[!gender.change$level=="",])
## 18 no responses
gender.change<-gender.change[!gender.change$level=="",]
# turn to percents
#male<-subset(gender.change, gender=="Male")
#female<-subset(gender.change, gender=="Female")
#other<-subset(gender.change, gender=="Other")
#gender.change$Location<-ifelse(gender.change$gender=="Male", (gender.change$Location/sum(male$Location))*100, gender.change$Location)
#gender.change$Location<-ifelse(gender.change$gender=="Female", (gender.change$Location/sum(female$Location))*100, gender.change$Location)
#gender.change$Location<-ifelse(gender.change$gender=="Other", (gender.change$Location/sum(other$Location))*100, gender.change$Location)
# change type to factor with levels
gender.change$type<-as.factor(gender.change$type)
gender.change$level<-str_replace_all(gender.change$level, "Will", "")
gender.change$level<-as.factor(gender.change$level)
# add colour palette
myColors<-(brewer.pal(9, "Blues"))
myColors<-(myColors[c(9, 6, 3)])
colScale <- scale_fill_manual(name = "type",values = myColors, labels=c("Fundamental", "Use-inspired", "Applied"))
#change order of levels
levels(gender.change$level)
#change order of levels
gender.change$level<-factor(gender.change$level, levels(gender.change$level)[c(1,3,2,6,4,5)])
gender.change$type<-factor(gender.change$type, levels(gender.change$type)[c(2,1,3)])
gender.change$type<-revalue(gender.change$type, c("success_change_10yrs_fundamental"="Fundamental",
'success_change_10yrs_use'='Use-inspired', 'success_change_10yrs_applied' = 'Applied'))
ggplot(data=gender.change, aes(x=level, Freq, fill=type))+
geom_bar(stat="identity", position="dodge")+
guides(fill=guide_legend(title=NULL)) +
theme(axis.text.x = element_text(angle=0, vjust=0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.text.y = element_text(size=14, face="bold", color="black"),
strip.background = element_rect(colour="white", fill="white"),
legend.position=c(0.15, 0.9))+
facet_wrap(~type, nrow=3) +
guides(fill=FALSE)+
geom_text(aes(label=Freq, vjust=-0.5)) +
scale_x_discrete(labels=c("Increase\n considerably", "Increase\n slightly",
"Stay the same", "Decrease\n slightly", "Decrease\n considerably", "Can't\n comment"),limits = (levels(gender.change$level)))+
labs(x="", y="No. of responses", fill="")+ colScale + ylim(c(0, 470))
```
#### Part 4 - Funding Trends
```{r, echo=FALSE, fig.cap="Perceived importance of fundamental research to Canada \n need to elabrate here but waiting to see if significant tests for gender, career, and stage return anything"}
## order bars from very important (left) to can't comment (right)
important<-subset(part4, select=c("Location","Country", "gender","opinion_fundamental_important"))
canada<-subset(important, Country=="Canada")
## using table to count cases of each category
sum.important<-data.frame(table(canada$opinion_fundamental_important, canada$gender))
# remove non-responses
sum.important<-sum.important[!sum.important$Var2=="",]
sum.important<-sum.important[!sum.important$Var1=="",]
perceive<-aggregate(Freq~Var1, sum.important, sum)
### colour palette
myColors<-(brewer.pal(9, "Blues"))
myColors<-(myColors[c(9, 7, 6, 4, 2)])
colScale <- scale_fill_manual(name = "Var1",values = myColors)
#gender.perceive<-aggregate(Freq ~ Var2 + Var1, sum.important, sum)
# turn to percents
#male<-subset(gender.perceive, Var2=="Male")
#female<-subset(gender.perceive, Var2=="Female")
#other<-subset(gender.perceive, Var2=="Other")
#gender.perceive$Freq<-ifelse(gender.perceive$Var2=='Male',(gender.perceive$Freq/sum(male$Freq))*100, gender.perceive$Freq)
#gender.perceive$Freq<-ifelse(gender.perceive$Var2=='Female',(gender.perceive$Freq/sum(female$Freq))*100, gender.perceive$Freq)
#gender.perceive$Freq<-ifelse(gender.perceive$Var2=='Other',(gender.perceive$Freq/sum(other$Freq))*100, gender.perceive$Freq)
ggplot(data=perceive, aes(x=Var1, y=Freq)) +
geom_bar(stat='identity', position='dodge',fill=myColors[2])+
labs(x="", y="No. of responses", fill="")+
geom_text(aes(label=Freq), vjust=-0.5) +
theme(axis.text.x = element_text(angle=0, vjust=0.4),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_x_discrete(limits = rev(levels(perceive$Var1)))#+ colScale
```
```{r, echo=FALSE, fig.cap="Perceived change in research priority by Canadian government \n need to elabrate here but waiting to see if significant tests for gender, career, and stage return anything"}
## order bars into applied > use > fundamental > no change
priority<-subset(part4, select=c("Location","Country", "gender", "high_priority_fundamental", "high_priority_use_inspired", "high_priority_applied",
"high_priority_no_change"))
canada<-subset(priority, Country=="Canada")
## switch to long format
priority.long<-gather(canada, what.type, higher.priority, -Location, -gender, -Country)
# remove non-responses (n = 1066)
dim(priority.long[!priority.long$higher.priority=="",])/4
priority.long<-priority.long[!priority.long$higher.priority=="",]
per.change<-aggregate(higher.priority~what.type, priority.long, sum)
#gender.perceive<-aggregate(higher.priority ~ gender + what.type, priority.long, sum)
# turn to percents
#male<-subset(gender.perceive, gender=="Male")
#female<-subset(gender.perceive, gender=="Female")
#other<-subset(gender.perceive, gender=="Other")
#gender.perceive$higher.priority<-ifelse(gender.perceive$gender=='Male',(gender.perceive$higher.priority/sum(male$higher.priority))*100, #gender.perceive$higher.priority)
#gender.perceive$higher.priority<-ifelse(gender.perceive$gender=='Female',(gender.perceive$higher.priority/sum(female$higher.priority))*100, #gender.perceive$higher.priority)
#gender.perceive$higher.priority<-ifelse(gender.perceive$gender=='Other',(gender.perceive$higher.priority/sum(other$higher.priority))*100, #gender.perceive$higher.priority)
# change order of the levels
per.change$what.type<-as.factor(per.change$what.type)
per.change$what.type<-factor(per.change$what.type, levels(per.change$what.type)[c(2,4,1,3)])
ggplot(data=per.change, aes(x=what.type, higher.priority))+
geom_bar(stat="identity", position='dodge', fill=myColors[2])+
theme(axis.text.x = element_text(),
axis.text.x = element_text(angle=45, vjust=0.4),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
labs(x="", y="No. of responses", fill="") +
scale_x_discrete(labels=c( "Fundamental", "Use-inspired","Applied", "No change"))   +
geom_text(aes(label=higher.priority), vjust=-0.5)
```
```{r, echo=FALSE, fig.cap="Anticipated change in research funding in next 5 years in Canada \n need to elabrate here but waiting to see if significant tests for gender, career, and stage return anything "}
## change in funding on the x-axis, and colours = type of research
## order bars into increase considerably (left) to decrease considerably (right), then no comment at the far right
availability.change<-subset(part4, select=c("Location", "Country", "gender", "available_funding_fundamental",
"available_funding_use_inspired", "available_funding_applied"))
canada<-subset(availability.change, Country=="Canada")
## switch to long format
availability.change.long.ca<-gather(canada, what.type, level, -gender, -Location, -Country)
head(availability.change.long.ca)
availability.ca<-with(availability.change.long.ca, data.frame(table(what.type, level)))
#remove non response
availability.ca<-availability.ca[!availability.ca$level=="",]
#gender.perceive<-aggregate(Location ~ what.type + gender+level, availability.change.long.ca, length)
#availability.ca<-aggregate(gender~what.type+level, availability.change.long.ca,length)
# remove non-response
#gender.perceive<-gender.perceive[!gender.perceive$level=="",]
#gender.perceive<-gender.perceive[!gender.perceive$gender=="",]
# turn to percents
#male<-subset(gender.perceive, gender=="Male")
#female<-subset(gender.perceive, gender=="Female")
#other<-subset(gender.perceive, gender=="Other")
#gender.perceive$Location<-ifelse(gender.perceive$gender=='Male',(gender.perceive$Location/sum(male$Location))*100, gender.perceive$Location)
#gender.perceive$Location<-ifelse(gender.perceive$gender=='Female',(gender.perceive$Location/sum(female$Location))*100, gender.perceive$Location)
#gender.perceive$Location<-ifelse(gender.perceive$gender=='Other',(gender.perceive$Location/sum(other$Location))*100, gender.perceive$Location)
## change type to factor with levels
availability.ca$level<-str_replace_all(availability.ca$level, "Will ", "")
availability.ca$what.type<-as.factor(availability.ca$what.type)
availability.ca$level<-as.factor(availability.ca$level)
levels(availability.ca$level)
## change order of levels
availability.ca$level<-factor(availability.ca$level, levels(availability.ca$level)[c(4,5,6,3,2,1 )])
availability.ca$what.type<-factor(availability.ca$what.type, levels(availability.ca$what.type)[c(2,3,1)])
availability.ca$what.type<-revalue(availability.ca$what.type, c("available_funding_fundamental"="Fundamental",
'available_funding_use_inspired'='Use-inspired', 'available_funding_applied' = 'Applied'))
### colour palette
myColors<-(brewer.pal(9, "Blues"))
myColors<-(myColors[c(9, 6,3)])
colScale <- scale_fill_manual(name = "what.type",values = myColors)
ggplot(data=availability.ca, aes(x=level, Freq, fill=what.type))+
geom_bar(stat="identity", position="dodge")+
theme(axis.text.x = element_text(angle=0, vjust=0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
strip.text.y = element_text(size=14, face="bold", color="black"),
strip.background = element_rect(colour="white", fill="white"),
legend.position=c(0.8, 0.2))+
guides(fill=FALSE)+
labs(x="", y="No. of responses", fill="")+
scale_x_discrete(labels=c("Increase\n considerably", "Increase\n slightly",
"Stay the same", "Decrease\n slightly", "Decrease\n considerably", "Can't\n comment"))+
facet_wrap(~what.type,nrow=3)+
geom_text(aes(label=Freq), vjust=-0.5) + colScale +ylim(c(0, 440))
```
```{r, echo=FALSE, fig.cap="Effect of change in research funding on research careers of next generation in Canada \n need to elabrate here but waiting to see if significant tests for gender, career, and stage return anything"}
## order bars into increase considerably (left) to decrease considerably (right), then no comment at the far right
next.generation<-subset(part4, select=c("Location", "Country", "gender","next_generation"))
# remove non-response
next.generation<-next.generation[!next.generation$next_generation=="",]
canada<-subset(next.generation, Country=="Canada")
impact<-data.frame(table(canada$next_generation))
## change type to factor with levels
impact$Var1<-str_replace_all(impact$Var1, "Will ", "")
impact$Var1<-as.factor(impact$Var1)
impact<-impact[!impact$Var1=="",]
## change order of Var1s
impact$Var1<-factor(impact$Var1, levels(impact$Var1)[c(4,5,6,3,2,1)])
impact<-droplevels(impact)
ggplot(data=impact, aes(x=Var1, Freq))+
geom_bar(stat='identity', position="dodge", fill=myColors[2])  +
scale_x_discrete(labels=c("Increase considerably","Increase slightly","Stay the same","Decrease slightly","Decrease considerably", "Can't comment")) +
guides(fill=FALSE) +
labs(x="", y="No. of responses")+
theme(axis.text.x = element_text(angle=0, vjust=0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
geom_text(aes(label=Freq), vjust=-0.5)
```
important<-subset(part4, select=c("Location","Country", "gender","opinion_fundamental_important"))
canada<-subset(important, Country=="Canada")
## using table to count cases of each category
sum.important<-data.frame(table(canada$opinion_fundamental_important, canada$gender))
# remove non-responses
sum.important<-sum.important[!sum.important$Var2=="",]
sum.important<-sum.important[!sum.important$Var1=="",]
perceive<-aggregate(Freq~Var1, sum.important, sum)
### colour palette
myColors<-(brewer.pal(9, "Blues"))
myColors<-(myColors[c(9, 7, 6, 4, 2)])
colScale <- scale_fill_manual(name = "Var1",values = myColors)
#gender.perceive<-aggregate(Freq ~ Var2 + Var1, sum.important, sum)
# turn to percents
#male<-subset(gender.perceive, Var2=="Male")
#female<-subset(gender.perceive, Var2=="Female")
#other<-subset(gender.perceive, Var2=="Other")
#gender.perceive$Freq<-ifelse(gender.perceive$Var2=='Male',(gender.perceive$Freq/sum(male$Freq))*100, gender.perceive$Freq)
#gender.perceive$Freq<-ifelse(gender.perceive$Var2=='Female',(gender.perceive$Freq/sum(female$Freq))*100, gender.perceive$Freq)
#gender.perceive$Freq<-ifelse(gender.perceive$Var2=='Other',(gender.perceive$Freq/sum(other$Freq))*100, gender.perceive$Freq)
ggplot(data=perceive, aes(x=Var1, y=Freq)) +
geom_bar(stat='identity', position='dodge',fill=myColors[2])+
labs(x="", y="No. of responses", fill="")+
scale_x_discrete(labels=c("Very\n important", "Somewhat\n important", 'Not very\n important', 'Not at all\n important', "Can't\n comment"))+
geom_text(aes(label=Freq), vjust=-0.5) +
theme(axis.text.x = element_text(angle=0, vjust=0.4),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_x_discrete(limits = rev(levels(perceive$Var1)))#+ colScale
ggplot(data=perceive, aes(x=Var1, y=Freq)) +
geom_bar(stat='identity', position='dodge',fill=myColors[2])+
labs(x="", y="No. of responses", fill="")+
# scale_x_discrete(labels=c("Very\n important", "Somewhat\n important", 'Not very\n important', 'Not at all\n important', "Can't\n comment"))+
geom_text(aes(label=Freq), vjust=-0.5) +
theme(axis.text.x = element_text(angle=0, vjust=0.4),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_x_discrete(limits = rev(levels(perceive$Var1)))#+ colScale
ggplot(data=perceive, aes(x=Var1, y=Freq)) +
geom_bar(stat='identity', position='dodge',fill=myColors[2])+
labs(x="", y="No. of responses", fill="")+
scale_x_discrete(labels=c("Very\n important", "Somewhat\n important", 'Not very\n important', 'Not at all\n important', "Can't\n comment"))+
geom_text(aes(label=Freq), vjust=-0.5) +
theme(axis.text.x = element_text(angle=0, vjust=0.4),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
canada<-subset(part3.part.long, Country=="Canada")
canada$year<-as.character(canada$year)
canada$year[canada$year=="practical_applications_important_11_15"]<-"2011-2015"
canada$year[canada$year=="practical_applications_important_6_10"]<-"2006-2010"
part.ca<-data.frame(table(canada$year, canada$level))
#change order of levels
part.ca$Var2<-factor(part.ca$Var2, levels(part.ca$Var2)[c(2,5,6,4,3,1)])
## add colour scale
myColors<-(brewer.pal(9, "Blues"))
myColors<-rev(myColors[c(9, 5)])
colScale <- scale_fill_manual(name = "Var1",values = myColors)
ggplot(part.ca, aes(Var2, Freq, fill=Var1))+
geom_bar(stat="identity", position = "dodge")+
guides(fill=guide_legend(title=NULL, reverse=FALSE)) +
labs(x="", y="No. of responses")+
scale_x_discrete(labels=c("Mandatory", "Quite\n important", 'Somewhat\n important', 'Not at all\n important', "Can't\n comment"))+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position=c(0.8, 0.8)) + colScale
part.ca
ggplot(part.ca, aes(Var2, Freq, fill=Var1))+
geom_bar(stat="identity", position = "dodge")+
guides(fill=guide_legend(title=NULL, reverse=FALSE)) +
labs(x="", y="No. of responses")+
scale_x_discrete(labels=c("Mandatory", "Quite\n important", 'Somewhat\n important',"Not at all\n important", 'Not at all\n important', "Can't\n comment"))+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position=c(0.8, 0.8)) + colScale
setwd("/Users/IMAC3/Documents/git-jpwrobinson/gya-research")
