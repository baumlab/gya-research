ggplot(data=sum.important, aes(x=Var1, y=Freq, fill=Var1)) + geom_bar(stat='identity')+
theme(axis.text.x = element_text(angle=90, vjust=0.5))
##8c  countries
country.sum.important<-data.frame(table(important$opinion_fundamental_important, important$Country))
# remove non-response
country.sum.important<-country.sum.important[!country.sum.important$Var1=="",]
head(country.sum.important)
ggplot(data=country.sum.important, aes(x=Var1, y=Freq, fill=Var2)) + geom_bar(stat='identity') +  theme(axis.text.x = element_text(angle=90, vjust=0.5))
ggplot(data=country.sum.important, aes(x=Var2, y=Freq, fill=Var1)) + geom_bar(stat='identity') +  theme(axis.text.x = element_text(angle=90, vjust=0.5))
## 9a  What type of research is higher priority for your gov
priority<-subset(part4, select=c("Location","Country", "gender", "high_priority_fundamental", "high_priority_use_inspired", "high_priority_applied",
"high_priority_no_change"))
## switch to long format
require(tidyr)
priority.long<-gather(priority, what.type, higher.priority, -Location, -gender, -Country)
head(priority.long)
#high.priority<-aggregate(higher.priority~ what.type, priority.long, length)
high.priority<-aggregate(higher.priority~ what.type, priority.long, sum)
ggplot(data=high.priority, aes(x=what.type, higher.priority, fill=what.type)) + geom_bar(stat='identity') +
theme(axis.text.x = element_text(angle=90, vjust=0.5))
## 9c  countries
country.high.priority<-aggregate(higher.priority~ what.type + Country, priority.long, sum)
ggplot(data=country.high.priority, aes(x=Country, y=higher.priority, fill=what.type)) + geom_bar(stat='identity') +
theme(axis.text.x = element_text(angle=90, vjust=0.5))
## 9b Canada
priority<-subset(part4, select=c("Location","Country", "gender", "high_priority_fundamental", "high_priority_use_inspired", "high_priority_applied",
"high_priority_no_change"))
canada<-subset(priority, Country=="Canada")
## switch to long format
require(tidyr)
priority.long<-gather(canada, what.type, higher.priority, -Location, -gender, -Country)
head(priority.long)
high.priority<-aggregate(higher.priority~ what.type, priority.long, sum)
ggplot(data=high.priority, aes(x=what.type, higher.priority, fill=what.type)) + geom_bar(stat='identity') +
theme(axis.text.x = element_text(angle=90, vjust=0.5))
######10a  Availiability of research funding will change in your country of work in the next 5 yrs
availiability.change<-subset(part4, select=c("Location", "Country", "gender", "available_funding_fundamental",
"available_funding_use_inspired", "available_funding_applied"))
## switch to long format
require(tidyr)
availiability.change.long<-gather(availiability.change, what.type, level, -Location, -gender, -Country)
head(availiability.change.long)
availiability<-aggregate(gender~what.type+level,
availiability.change.long,length)
# remove non-response
availiability<-availiability[!availiability$level=="",]
ggplot(data=availiability, aes(x=what.type, gender, fill=level))+ geom_bar(stat='identity') +
theme(axis.text.x = element_text(angle=90, vjust=0.5))
##10b countries
availiability.cont<-aggregate(gender~what.type+level+Country,
availiability.change.long,length)
# remove non-response
availiability.cont<-availiability.cont[!availiability.cont$level=="",]
ggplot(data=availiability.cont, aes(x=what.type, gender, fill=level))+ geom_bar(stat='identity') +
theme(axis.text.x = element_text(angle=90, vjust=0.5)) + facet_wrap(~ Country)
###subset out the countries with more than ~5 responses
########################not done###################
##################################################
##################################################
availiability.change<-subset(part4, select=c("Location", "Country", "gender", "available_funding_fundamental",
"available_funding_use_inspired", "available_funding_applied"))
head(availiability.change)
#five.countries<-subset(availiability.change, Country=="USA","United Kingdom","Canada","Israel","Italy")
###10c-Canada
availiability.change<-subset(part4, select=c("Location", "Country", "gender", "available_funding_fundamental",
"available_funding_use_inspired", "available_funding_applied"))
canada<-subset(availiability.change, Country=="Canada")
## switch to long format
require(tidyr)
availiability.change.long.ca<-gather(canada, what.type, level, -Location, -gender, -Country)
availiability.ca<-aggregate(gender~what.type+level,
availiability.change.long.ca,length)
head(availiability.ca)
# remove non-response
availiability.ca<-availiability.ca[!availiability.ca$level=="",]
ggplot(data=availiability.ca, aes(x=what.type, gender, fill=level))+ geom_bar(stat='identity') +
theme(axis.text.x = element_text(angle=90, vjust=0.5))
##11a changes in funding influence the next generation
next.generation<-subset(part4, select=c("Location", "Country", "gender","next_generation"))
# remove non-response
next.generation<-next.generation[!next.generation$next_generation=="",]
impact<-aggregate(gender~ next_generation, next.generation, length)
head(impact)
ggplot(data=impact, aes(x=next_generation, gender, fill=next_generation)) + geom_bar(stat='identity') +
theme(axis.text.x = element_text(angle=90, vjust=0.5))
##11b countries
country.impact<-aggregate(gender~ next_generation + Country, next.generation, length)
# remove non-response
country.impact<-country.impact[!country.impact$next_generation=="",]
ggplot(data=country.impact, aes(x=Country, y=gender, fill=next_generation)) + geom_bar(stat='identity') +
theme(axis.text.x = element_text(angle=90, vjust=0.5))
##11c Canada
next.generation<-subset(part4, select=c("Location", "Country", "gender","next_generation"))
# remove non-response
next.generation<-next.generation[!next.generation$next_generation=="",]
canada<-subset(next.generation, Country=="Canada")
head(canada)
impact<-aggregate(gender~ next_generation, canada, length)
head(impact)
ggplot(data=impact, aes(x=next_generation, gender, fill=next_generation)) + geom_bar(stat='identity') +
theme(axis.text.x = element_text(angle=90, vjust=0.5))
###############
####Part2######
###############
###12a current partnership
b.part<-aggregate(gender~  partnership_outside_before, part2.b.a, length)
colnames(b.part)[1]<-"partnership_outside"
b.part$time<-"Past"
a.part<-aggregate(gender~ partnership_outside, part2.b.a, length)
a.part$time<-"Current"
part<-rbind(a.part, b.part)
# change order of the levels
part$partnership_outside<-as.factor(part$partnership_outside)
part$partnership_outside<-factor(part$partnership_outside, levels(part$partnership_outside)[c(1,4,3,2)])
ggplot() +
geom_bar(data=part, aes(x=partnership_outside, y=gender, fill = time), stat='identity', position="dodge") +
theme(axis.text.x = element_text(angle=90, vjust=0.5))+labs(x="", y="Number of Responses", fill="")+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
###12b canada
canada<-subset(part2.b.a, Country=="Canada")
current.part.ca<-aggregate(gender~ partnership_outside, canada, length)
# change order of the levels
current.part.ca$partnership_outside<-as.factor(current.part.ca$partnership_outside)
current.part.ca$partnership_outside<-factor(current.part.ca$partnership_outside, levels(current.part.ca$partnership_outside)[c(1,4,3,2)])
ggplot(data=current.part.ca, aes(x=partnership_outside, gender, fill=partnership_outside))+geom_bar(stat='identity')+
theme(axis.text.x = element_text(angle=90, vjust=0.5))+labs(x="", y="Number of Responses", fill="")+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+ guides(fill=FALSE)
####13a  change in partnership
head(part2.change)
change.part<-aggregate(gender~ partnership_change_10yrs, part2.change, length)
ggplot(data=change.part, aes(x=partnership_change_10yrs, gender, fill=partnership_change_10yrs))+geom_bar(stat='identity')+
theme(axis.text.x = element_text(angle=0, vjust=0.5))+labs(x="", y="Number of Responses", fill="")+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+ guides(fill=FALSE)
###13b Canada
canada<-subset(part2.change, Country=="Canada")
change.part.ca<-aggregate(gender~ partnership_change_10yrs, canada, length)
ggplot(data=change.part.ca, aes(x=partnership_change_10yrs, gender, fill=partnership_change_10yrs))+geom_bar(stat='identity')+
theme(axis.text.x = element_text(angle=0, vjust=0.5))+labs(title="Change in past 10yrs", x="", y="Number of Responses", fill="")+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+ guides(fill=FALSE)
###14a Reason for change
head(part2.reason)
require(tidyr)
reason.pt.long<-gather(part2.reason, change.reason, yes, -Country, -gender, -Location)
unique(reason.pt.long$change.reason)
sum.reason<-data.frame(table(reason.pt.long$change.reason, reason.pt.long$yes))
ggplot(data=sum.reason, aes(x=reorder(Var1, -Freq), y=Freq, fill=Var1)) + geom_bar(stat='identity')+
theme(axis.text.x = element_text(angle=0, vjust=0.5)) + guides(fill=FALSE)+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+labs(title= "Reason for Change", x="", y="Number of Responses")+
scale_x_discrete(labels=c("Funding Related", "Interest Related", "Career Related", "Socially Related", "Other"))
### 14b Canada
canada<-subset(part2.reason, Country=="Canada")
require(tidyr)
reason.pt.long<-gather(canada, change.reason, yes, -Country, -gender, -Location)
unique(reason.pt.long$change.reason)
sum.reason<-data.frame(table(reason.pt.long$change.reason, reason.pt.long$yes))
ggplot(data=sum.reason, aes(x=reorder(Var1, -Freq), y=Freq, fill=Var1)) + geom_bar(stat='identity')+
theme(axis.text.x = element_text(angle=0, vjust=0.5)) + guides(fill=FALSE)+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+labs(title= "Reason for Change", x="", y="Number of Responses")+
scale_x_discrete(labels=c("Funding Related", "Interest Related", "Career Related", "Socially Related", "Other"))
####15a View of Change
view<-aggregate(gender~ view_change_partnership, part2.view, length)
levels(view$view_change_partnership)
# change order of the levels
view$view_change_partnership<-factor(view$view_change_partnership, levels(view$view_change_partnership)[c(6,4,2,3,5)])
ggplot(data=view, aes(x=view_change_partnership, y=gender, fill=view_change_partnership)) + geom_bar(stat='identity')+
theme(axis.text.x = element_text(angle=0, vjust=0.5)) + guides(fill=FALSE)+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+labs(title= "View of Change", x="", y="Number of Responses")
###15b Canada
canada<-subset(part2.view, Country=="Canada")
view<-aggregate(gender~ view_change_partnership, canada, length)
levels(view$view_change_partnership)
# change order of the levels
view$view_change_partnership<-factor(view$view_change_partnership, levels(view$view_change_partnership)[c(6,4,2,3,5)])
ggplot(data=view, aes(x=view_change_partnership, y=gender, fill=view_change_partnership)) + geom_bar(stat='identity')+
theme(axis.text.x = element_text(angle=0, vjust=0.5)) + guides(fill=FALSE)+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+labs(x="", y="Number of Responses")
###############
####Part3######
###############
## 17a  grant applications  all countries
head(part3.grants.long)
str(part3.grants.long)
part3.grants.long$type.grant<-as.character(part3.grants.long$type.grant)
#add time variable
part3.grants.long$time<-ifelse(grepl("11_15", part3.grants.long$type.grant), "2011-2015", "2006-2010")
part3.grants.long$type.grant[part3.grants.long$type.grant=="external_pi_grant_11_15_fundamental"]<-"Fundamental"
part3.grants.long$type.grant[part3.grants.long$type.grant=="external_pi_grant_6_10_fundamental"]<-"Fundamental"
part3.grants.long$type.grant[part3.grants.long$type.grant=="external_pi_grant_11_15_use"]<-"Use-Inspired"
part3.grants.long$type.grant[part3.grants.long$type.grant=="external_pi_grant_6_10_use"]<-"Use-Inspired"
part3.grants.long$type.grant[part3.grants.long$type.grant=="external_pi_grant_11_15_applied"]<-"Applied"
part3.grants.long$type.grant[part3.grants.long$type.grant=="external_pi_grant_6_10_applied"]<-"Applied"
grants<-aggregate(gender~ type.grant+time+number, part3.grants.long, length)
grants$type.grant<-as.factor(grants$type.grant)
#change order of levels
grants$number<-factor(grants$number, levels(grants$number)[c(1,2,6,7,3,4,5)])
grants$type.grant<-factor(grants$type.grant, levels(grants$type.grant)[c(2,3,1)])
ggplot(grants, aes(type.grant, gender, fill=number)) + geom_bar(stat="identity", position = "dodge")+facet_wrap(~time) +guides(fill=guide_legend(title=NULL, reverse=FALSE)) +
labs(x="Number of grant applications", y="Number of responses")+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
## 17b  canada
canada<-subset(part3.grants.long, Country=="Canada")
canada$type.grant<-as.character(canada$type.grant)
#add time variable
canada$time<-ifelse(grepl("11_15", canada$type.grant), "2011-2015", "2006-2010")
canada$type.grant[canada$type.grant=="external_pi_grant_11_15_fundamental"]<-"Fundamental"
canada$type.grant[canada$type.grant=="external_pi_grant_6_10_fundamental"]<-"Fundamental"
canada$type.grant[canada$type.grant=="external_pi_grant_11_15_use"]<-"Use-Inspired"
canada$type.grant[canada$type.grant=="external_pi_grant_6_10_use"]<-"Use-Inspired"
canada$type.grant[canada$type.grant=="external_pi_grant_11_15_applied"]<-"Applied"
canada$type.grant[canada$type.grant=="external_pi_grant_6_10_applied"]<-"Applied"
grants.ca<-aggregate(gender~ type.grant+time+number, canada, length)
grants.ca$type.grant<-as.factor(grants.ca$type.grant)
#change order of levels
grants.ca$number<-factor(grants.ca$number, levels(grants.ca$number)[c(1,2,6,7,3,4,5)])
grants.ca$type.grant<-factor(grants.ca$type.grant, levels(grants.ca$type.grant)[c(2,3,1)])
ggplot(grants.ca, aes(type.grant, gender, fill=number)) + geom_bar(stat="identity", position = "dodge")+facet_wrap(~time) +guides(fill=guide_legend(title=NULL, reverse=FALSE)) +
labs(x="Number of grant applications", y="Number of responses")+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
#### 18a percent of applications successful
part3.success.long$type<-as.character(part3.success.long$type)
#add time variable
part3.success.long$time<-ifelse(grepl("11_15", part3.success.long$type), "2011-2015", "2006-2010")
part3.success.long$type[part3.success.long$type=="successful_grants_11_15_fundamental"]<-"Fundamental"
part3.success.long$type[part3.success.long$type=="successful_grants_6_10_fundamental"]<-"Fundamental"
part3.success.long$type[part3.success.long$type=="successful_grants_11_15_use"]<-"Use-Inspired"
part3.success.long$type[part3.success.long$type=="successful_grants_6_10_use"]<-"Use-Inspired"
part3.success.long$type[part3.success.long$type=="successful_grants_11_15_applied"]<-"Applied"
part3.success.long$type[part3.success.long$type=="successful_grants_6_10_applied"]<-"Applied"
success<-aggregate(gender~type+percent+time, part3.success.long, length)
#change order of types
success$type<-as.factor(success$type)
success$type<-factor(success$type, levels(success$type)[c(2,3,1)])
ggplot(success, aes(percent, gender, fill=time))+geom_bar(stat="identity", position = "dodge")+facet_wrap(~type)+
guides(fill=guide_legend(title=NULL, reverse=FALSE)) +
labs(x="Percent of success", y="Number of responses")+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
## 18b canada
canada<-subset(part3.success.long, Country=="Canada")
canada$type<-as.character(canada$type)
#add time variable
canada$time<-ifelse(grepl("11_15", canada$type), "2011-2015", "2006-2010")
canada$type[canada$type=="successful_grants_11_15_fundamental"]<-"Fundamental"
canada$type[canada$type=="successful_grants_6_10_fundamental"]<-"Fundamental"
canada$type[canada$type=="successful_grants_11_15_use"]<-"Use-Inspired"
canada$type[canada$type=="successful_grants_6_10_use"]<-"Use-Inspired"
canada$type[canada$type=="successful_grants_11_15_applied"]<-"Applied"
canada$type[canada$type=="successful_grants_6_10_applied"]<-"Applied"
success.ca<-aggregate(gender~type+percent+time, canada, length)
#change order of types
success.ca$type<-as.factor(success.ca$type)
success.ca$type<-factor(success.ca$type, levels(success.ca$type)[c(2,3,1)])
ggplot(success.ca, aes(percent, gender, fill=time))+geom_bar(stat="identity", position = "dodge")+facet_wrap(~type)+
guides(fill=guide_legend(title=NULL, reverse=FALSE)) +
labs(x="Percent of success", y="Number of responses")+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
#### 19a suggesting practical applications
part3.prac.long$year<-as.character(part3.prac.long$year)
part3.prac.long$year[part3.prac.long$year=="practical_applications_important_11_15"]<-"2011-2015"
part3.prac.long$year[part3.prac.long$year=="practical_applications_important_6_10"]<-"2006-2010"
prac<-aggregate(gender~year+level, part3.prac.long, length)
#change order of levels
prac$level<-factor(prac$level, levels(prac$level)[c(2,6,4,5,3,1)])
ggplot(prac, aes(level, gender, fill=year))+ geom_bar(stat="identity", position = "dodge")+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
guides(fill=guide_legend(title=NULL, reverse=FALSE)) + labs(x="", y="Number of responses")+theme(axis.text.x = element_text(angle=90, vjust=0.5))
## 19b Canada
canada<-subset(part3.prac.long, Country=="Canada")
canada$year<-as.character(canada$year)
canada$year[canada$year=="practical_applications_important_11_15"]<-"2011-2015"
canada$year[canada$year=="practical_applications_important_6_10"]<-"2006-2010"
prac.ca<-aggregate(gender~year+level, canada, length)
#change order of levels
prac.ca$level<-factor(prac.ca$level, levels(prac.ca$level)[c(2,6,4,5,3,1)])
ggplot(prac.ca, aes(level, gender, fill=year))+ geom_bar(stat="identity", position = "dodge")+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
guides(fill=guide_legend(title=NULL, reverse=FALSE)) + labs(x="", y="Number of responses")+theme(axis.text.x = element_text(angle=90, vjust=0.5))
#####20a include partners from for profit or non gov sectors
part3.part.long$year<-as.character(part3.part.long$year)
part3.part.long$year[part3.part.long$year=="include_nonacademia_partners_success_11_15"]<-"2011-2015"
part3.part.long$year[part3.part.long$year=="include_nonacademia_partners_success_6_10"]<-"2006-2010"
head(part3.part.long)
partner<-aggregate(gender~year+level, part3.part.long, length)
#change order of levels
partner$level<-factor(partner$level, levels(partner$level)[c(2,5,6,4,3,1)])
ggplot(partner, aes(level, gender, fill=year))+ geom_bar(stat="identity", position = "dodge")+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
guides(fill=guide_legend(title=NULL, reverse=FALSE)) + labs(x="", y="Number of responses")+theme(axis.text.x = element_text(angle=90, vjust=0.5))
## 20b Canada
canada<-subset(part3.part.long, Country=="Canada")
canada$year<-as.character(canada$year)
canada$year[canada$year=="include_nonacademia_partners_success_11_15"]<-"2011-2015"
canada$year[canada$year=="include_nonacademia_partners_success_6_10"]<-"2006-2010"
part.ca<-aggregate(gender~year+level, canada, length)
#change order of levels
part.ca$level<-factor(part.ca$level, levels(part.ca$level)[c(2,5,6,4,3,1)])
ggplot(part.ca, aes(level, gender, fill=year))+ geom_bar(stat="identity", position = "dodge")+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
guides(fill=guide_legend(title=NULL, reverse=FALSE)) + labs(x="", y="Number of responses")+theme(axis.text.x = element_text(angle=90, vjust=0.5))
#### 21a distribution of funding
head(p3_master.long)
ggplot(p3_master.long, aes(percent, fill=year))+ geom_histogram(position='dodge', binwidth=25)  +  facet_wrap(~type)
## 21b
canada<-subset(p3_master.long, Country=="Canada")
ggplot(canada, aes(percent, fill=year))+ geom_histogram(position='dodge', binwidth=25)  +  facet_wrap(~type)
## grant success rates change in last 10 yrs
head(part3.change)
require(tidyr)
##switch to long format
change.long<-gather(part3.change, type, level, -Location, -gender, -Country)
head(change.long)
change<-aggregate(gender~type+level, change.long, length)
# remove non-response
change<-change[!change$level=="",]
ggplot(data=change, aes(x=level, gender, fill=type))+ geom_bar(stat='identity', position = "dodge") +
theme(axis.text.x = element_text(angle=90, vjust=0.5))
## Canada  by gender
canada<-subset(part3.change, Country=="Canada")
require(tidyr)
##switch to long format
change.long.ca<-gather(canada, type, level, -Location, -gender, -Country)
head(change.long.ca)
gender.change<-aggregate(Location~type+gender+level, change.long.ca, length)
head(gender.change)
#remove no response
gender.change<-gender.change[!gender.change$gender=="",]
gender.change<-gender.change[!gender.change$level=="",]
# turn to percents
male<-subset(gender.change, gender=="Male")
female<-subset(gender.change, gender=="Female")
other<-subset(gender.change, gender=="Other")
gender.change$Location<-ifelse(gender.change$gender=="Male", (gender.change$Location/sum(male$Location))*100, gender.change$Location)
gender.change$Location<-ifelse(gender.change$gender=="Female", (gender.change$Location/sum(female$Location))*100, gender.change$Location)
gender.change$Location<-ifelse(gender.change$gender=="Other", (gender.change$Location/sum(other$Location))*100, gender.change$Location)
str(gender.change)
# change type to factor with levels
gender.change$type<-as.factor(gender.change$type)
gender.change$level<-str_replace_all(gender.change$level, "Will", "")
gender.change$level<-as.factor(gender.change$level)
#change order of levels
gender.change$level<-factor(gender.change$level, levels(gender.change$level)[c(1,3,2,6,4,5)])
gender.change$type<-factor(gender.change$type, levels(gender.change$type)[c(2,3,1)])
ggplot(data=gender.change, aes(x=level, Location, fill=type))+geom_bar(stat="identity", position="dodge")+ scale_x_discrete(limits = rev(levels(gender.change$level)))+
facet_wrap(~gender)+theme(axis.text.x = element_text(angle=90, vjust=0.5))+labs(x="", y="Percentage of responses", fill="")+
scale_fill_discrete(labels=c("Fundamental", "Use-inspired", "Applied")) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
dev.off()
availiability.change<-subset(part4, select=c("Location", "Country", "Country_work", "gender", "available_funding_fundamental",
"available_funding_use_inspired", "available_funding_applied"))
canada<-subset(availiability.change, Country=="Canada")
availiability.change<-subset(part4, select=c("Location", "Country", "Country_work", "gender", "available_funding_fundamental",
"available_funding_use_inspired", "available_funding_applied"))
part4<-read.csv(file="data/gya-survey-part4.csv")
colnames(part4)
write.csv(survey.part4, file="data/gya-survey-part4.csv", row.names = FALSE)
part4<-read.csv(file="data/gya-survey-part4.csv")
colnames(part4)
availiability.change<-subset(part4, select=c("Location", "Country", "Country_work", "gender", "available_funding_fundamental",
"available_funding_use_inspired", "available_funding_applied"))
canada<-subset(availiability.change, Country=="Canada")
## switch to long format
require(tidyr)
availiability.change.long.ca<-gather(canada, what.type, level, -Location, -gender, Country_work, -Country)
colnames(canada)
head(canada)
availiability.change.long.ca<-gather(canada, what.type, level, -Location, -gender, -Country_work, -Country)
availiability.ca<-aggregate(gender~what.type+level,
availiability.change.long.ca,length)
head(availiability.ca)
ggplot(data=availiability.ca, aes(x=what.type, gender, fill=level))+ geom_bar(stat='identity') +
theme(axis.text.x = element_text(angle=90, vjust=0.5))
setwd("/Users/kristinatietjen/Documents/git_hub/gya-research")
survey<-read.csv(file="data/gya-without-incomplete.csv")
survey.what<-read.csv(file="data/gya-country-responses.csv")
research<-read.csv(file="data/gya-surveys-cleaned-research.csv")
#research.past<-read.csv(file="data/gya-surveys-cleaned-research-past.csv")
research.change<-read.csv(file="data/gya-change-reason.csv")
part4<-read.csv(file="data/gya-survey-part4.csv")
colnames(part4)
part2.b.a<-read.csv(file="data/gya-part2.before.after.csv")
part2.change<-read.csv(file="data/gya-part2.change.csv")
part2.reason<-read.csv(file="data/gya-part2.reason.csv")
part2.view<-read.csv(file="data/gya-part2.view.csv")
part1.view<-read.csv(file="data/gya-part1.view.csv")
part3.grants.long<-read.csv(file="data/gya-part3.grants.long.csv")
write.csv(survey.what, file="data/gya-country-responses.csv", row.names = FALSE)
write.csv(survey.long, file="data/gya-surveys-cleaned-research.csv", row.names = FALSE)
#write.csv(survey.long.past, file="data/gya-surveys-cleaned-research-past.csv", row.names = FALSE)
write.csv(survey.change, file="data/gya-change-reason.csv", row.names = FALSE)
write.csv(part1.view, file="data/gya-part1.view.csv", row.names = FALSE)
write.csv(survey.part4, file="data/gya-survey-part4.csv", row.names = FALSE)
write.csv(part2.b.a, file="data/gya-part2.before.after.csv", row.names = FALSE)
write.csv(part2.change, file="data/gya-part2.change.csv", row.names = FALSE)
write.csv(part2.reason, file="data/gya-part2.reason.csv", row.names=FALSE)
write.csv(part2.view, file="data/gya-part2.view.csv", row.names = FALSE)
write.csv(part3.grants.long, file="data/gya-part3.grants.long.csv", row.names = FALSE)
write.csv(part3.change, file="data/gya-part3.change.csv", row.names = FALSE)
write.csv(part3.success.long, file="data/gya-part3.success.long.csv", row.names = FALSE)
write.csv(part3.prac.long, file="data/gya-part3.prac.long.csv", row.names = FALSE)
write.csv(part3.part.long, file="data/gya-part3.part.long.csv", row.names = FALSE)
write.csv(p3_master.long, file="data/gya-p3_master.long.csv", row.names = FALSE)
write.csv(p3_master, file="data/gya-p3_master.csv", row.names = FALSE)
survey<-read.csv(file="data/gya-without-incomplete.csv")
survey.what<-read.csv(file="data/gya-country-responses.csv")
research<-read.csv(file="data/gya-surveys-cleaned-research.csv")
#research.past<-read.csv(file="data/gya-surveys-cleaned-research-past.csv")
research.change<-read.csv(file="data/gya-change-reason.csv")
part4<-read.csv(file="data/gya-survey-part4.csv")
colnames(part4)
part2.b.a<-read.csv(file="data/gya-part2.before.after.csv")
part2.change<-read.csv(file="data/gya-part2.change.csv")
part2.reason<-read.csv(file="data/gya-part2.reason.csv")
part2.view<-read.csv(file="data/gya-part2.view.csv")
part1.view<-read.csv(file="data/gya-part1.view.csv")
part3.grants.long<-read.csv(file="data/gya-part3.grants.long.csv")
part3.change<-read.csv(file="data/gya-part3.change.csv")
part3.success.long<-read.csv(file="data/gya-part3.success.long.csv")
part3.prac.long<-read.csv(file="data/gya-part3.prac.long.csv")
part3.part.long<-read.csv(file="data/gya-part3.part.long.csv")
p3_master.long<-read.csv(file="data/gya-p3_master.long.csv")
p3_master<-read.csv(file="data/gya-p3_master.csv")
colnames(survey.what)
colnames(research)
research
colnames(research.change)
colnames(part2.b.a)
colnames(part2.change)
colnames(part2.reason)
colnames(part2.view)
colnames(part1.view)
colnames(part3.grants.long)
colnames(part3.change)
colnames(part3.success.long)
colnames(part3.prac.long)
colnames(part3.part.long)
colnames(p3_master.long)
colnames(p3_master)
yes.no<-subset(research.change, select=c("Location","Country", "Country_work",  "gender", "changed_10yrs"))
## using table to count cases of each category
sum.yesno<-data.frame(table(yes.no$changed_10yrs))
# remove non-response
sum.yesno<-sum.yesno[!sum.yesno$Var1=="",]
ggplot(data=sum.yesno, aes(x=Var1, y=Freq, fill=Var1)) + geom_bar(stat='identity') + guides(fill=FALSE)
# 5b for Canada
canada<-subset(yes.no, Country=="Canada")
canada.yesno<-aggregate(Country~ changed_10yrs, canada, length)
canada.yesno<-canada.yesno[!canada.yesno$changed_10yrs=="",]
ggplot(data=canada.yesno, aes(x=changed_10yrs, y=Country, fill=Country))+ geom_bar(stat='identity') + guides(fill=FALSE)
research.change<-read.csv(file="data/gya-change-reason.csv")
reason<-subset(research.change, select=c("Location","Country","Country_work",  "gender", "Main_reason_change_interest_related",
"Main_reason_change_Career_related", "Main_reason_change_Funding_related","Main_reason_change_Socially_related",
"Main_reason_change_Other"))
research.change<-read.csv(file="data/gya-change-reason.csv")
reason<-subset(research.change, select=c("Location","Country","Country_work",  "gender", "Main_reason_change_interest_related",
"Main_reason_change_Career_related", "Main_reason_change_Funding_related","Main_reason_change_Socially_related",
"Main_reason_change_Other"))
head(reason)
## switch to long format
require(tidyr)
reason.long<-gather(reason, reason.change, yes, -Location, -gender, -Country_work, -Country)
head(reason.long)
sum.reason<-data.frame(table(reason.long$reason.change, reason.long$yes))
head(sum.reason)
ggplot(data=sum.reason, aes(x=Var1, y=Freq, fill=Var1)) + geom_bar(stat='identity')+
theme(axis.text.x = element_text(angle=90, vjust=0.5)) +guides(fill=FALSE)
## 7b canada
research.change<-read.csv(file="data/gya-change-reason.csv")
reason<-subset(research.change, select=c("Location","Country","Country_work",  "gender", "Main_reason_change_interest_related",
"Main_reason_change_Career_related", "Main_reason_change_Funding_related","Main_reason_change_Socially_related",
"Main_reason_change_Other"))
canada<-subset(reason, Country=="Canada")
canada.long<-gather(canada, reason.change.ca, yes.ca, -Location, -gender, -Country_work -Country)
require(tidyr)
canada.long<-gather(canada, reason.change.ca, yes.ca, -Location, -gender, -Country_work -Country)
colnames(canada)
## switch to long format
require(tidyr)
canada.long<-gather(canada, reason.change.ca, yes.ca, -Location, -gender, -Country_work -Country)
head(canada)
canada.long<-gather(canada, reason.change.ca, yes.ca, -Location, -gender, -Country_work, -Country)
## using table to count cases of each category
sum.canada<-data.frame(table(canada.long$reason.change.ca, canada.long$yes.ca))
# remove non-response
sum.canada<-sum.canada[!sum.canada$Var1=="",]
ggplot(sum.canada, aes(x=Var1, y=Freq, fill=Var1)) + geom_bar(stat='identity')+
theme(axis.text.x = element_text(angle=90, vjust=0.5)) +guides(fill=FALSE)
## 16a  View change
# remomve non-response
part1.view<-part1.view[!part1.view$view_change_of_type=="",]
part1.view<-droplevels(part1.view)
change.view<-aggregate(gender~ view_change_of_type, part1.view, length)
# change order of the levels
change.view$view_change_of_type<-factor(change.view$view_change_of_type,
levels(change.view$view_change_of_type)[c(5,3,1,2,4)])
ggplot(change.view, aes(x=view_change_of_type, y=gender, fill=view_change_of_type)) + geom_bar(stat='identity')+
theme(axis.text.x = element_text(angle=90, vjust=0.5)) +guides(fill=FALSE)+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+ labs(x="", y="Number of Responses")
# 16b Canada
canada<-subset(part1.view, Country=="Canada")
canada<-canada[!canada$view_change_of_type=="",]
change.view.ca<-aggregate(gender~ view_change_of_type, canada, length)
# change order of the levels
change.view.ca$view_change_of_type<-factor(change.view.ca$view_change_of_type,
levels(change.view.ca$view_change_of_type)[c(5,3,1,2,4)])
ggplot(change.view.ca, aes(x=view_change_of_type, y=gender, fill=view_change_of_type)) + geom_bar(stat='identity')+
theme(axis.text.x = element_text(angle=90, vjust=0.5)) +guides(fill=FALSE)+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+ labs(x="", y="Number of Responses")
###############
####Part4######
###############
part4<-read.csv(file="data/gya-survey-part4")
colnames(part4)
important<-subset(part4, select=c("Location","Country","Country_work", "gender","opinion_fundamental_important"))
## using table to count cases of each category
sum.important<-data.frame(table(important$opinion_fundamental_important))
# remove non-response
sum.important<-sum.important[!sum.important$Var1=="",]
ggplot(data=sum.important, aes(x=Var1, y=Freq, fill=Var1)) + geom_bar(stat='identity')+
theme(axis.text.x = element_text(angle=90, vjust=0.5))
part4<-read.csv(file="data/gya-survey-part4")
colnames(part4)
part4<-read.csv(file="data/gya-survey-part4.csv")
