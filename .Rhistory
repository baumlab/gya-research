sum.reason
sum.canada<-data.frame(table(reason.pt.long$change.reason, reason.pt.long$yes))
sum.canada$Var1<-revalue(sum.canada$Var1, c("reason_partnership_change_career" = "Career", "reason_partnership_change_funding" = "Funding", "reason_partnership_change_interest" = "Interest", "reason_partnership_change_other" = "Other", "reason_partnership_change_socially"  = "Social"))
sum.canada$Var1<-reorder(sum.canada$Var1, -sum.canada$Freq)
myColors<-(brewer.pal(9, "Blues"))
myColors<-myColors[c(9, 8,7,6,5)]
colScale <- scale_fill_manual(name = "Var1",values = myColors)
g2<-ggplot(sum.canada, aes(x=Var1, y=Freq, fill=Var1)) +
geom_bar(stat='identity')+  guides(fill=FALSE) +
theme(axis.text.x = element_text(angle=0, vjust=0.5),
legend.position=c(0.8, 0.8),
legend.title=element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
labs(x="", y="", title="")+
colScale
grid.arrange(g1, g2, nrow=1)
canada<-subset(part2.view, Country=="Canada")
view<-aggregate(gender~ view_change_partnership, canada, length)
# change order of the levels
view$view_change_partnership<-factor(view$view_change_partnership, levels(view$view_change_partnership)[c(6,4,2,3,5)])
ggplot(data=view, aes(x=view_change_partnership, y=gender, fill=view_change_partnership)) + geom_bar(stat='identity')+
theme(axis.text.x = element_text(angle=0, vjust=0.5)) + guides(fill=FALSE)+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+labs(x="", y="Number of Responses")
view<-data.frame(table(canada$view_change_partnership)
view<-data.frame(table(canada$view_change_partnership))
view<-data.frame(table(canada$view_change_partnership))
view
levels(view)
levels(view$Var1)
view$Var1<-factor(view$Var1, levels(view$Var1)[c(5,3,1,2,4)])
ggplot(data=view, aes(x=Var1, y=gender, fill=Var1)) + geom_bar(stat='identity')+
theme(axis.text.x = element_text(angle=0, vjust=0.5)) + guides(fill=FALSE)+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+labs(x="", y="Number of Responses")
## order bars from highest to lowest
# Change in the past 10 years? (yes, no, can't comment)
yes.no<-subset(research.change, select=c("Location","Country",  "gender", "changed_10yrs"))
canada<-subset(yes.no, Country=="Canada")
canada.yesno<-data.frame(table(canada$changed_10yrs))
canada.yesno<-canada.yesno[!canada.yesno$Var1=="",]
canada.yesno$Var1<-revalue(canada.yesno$Var1, c("Can't comment (new researcher)"="Can't comment"))
canada.yesno$Var1<-factor(canada.yesno$Var1, levels=c("Yes", "No", "Can't comment"))
myColors<-(brewer.pal(9, "Blues"))
myColors<-myColors[c(9, 7,5)]
colScale <- scale_fill_manual(name = "Var1",values = myColors)
g1<-ggplot(data=canada.yesno, aes(x=Var1, y=Freq, fill=Var1))+
geom_bar(stat='identity') +
guides(fill=FALSE) +
labs(x="", y="No. of responses",title="")+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) + colScale
## GRAPH PART 2
# What is your main reason for change?
reason<-subset(research.change, select=c("Location","Country",  "gender", "Main_reason_change_interest_related",
"Main_reason_change_Career_related", "Main_reason_change_Funding_related","Main_reason_change_Socially_related",
"Main_reason_change_Other"))
canada<-subset(reason, Country=="Canada")
## switch to long format
require(tidyr)
canada.long<-gather(canada, reason.change.ca, yes.ca, -Location, -gender, -Country)
## using table to count cases of each category
sum.canada<-data.frame(table(canada.long$reason.change.ca, canada.long$yes.ca))
sum.canada$Var1<-revalue(sum.canada$Var1, c("Main_reason_change_Career_related" = "Career", "Main_reason_change_Funding_related" = "Funding", "Main_reason_change_interest_related" = "Interest", "Main_reason_change_Other" = "Other", "Main_reason_change_Socially_related"  = "Social"))
sum.canada$Var1<-reorder(sum.canada$Var1, -sum.canada$Freq)
myColors<-(brewer.pal(9, "Blues"))
myColors<-myColors[c(9, 8,7,6,5)]
colScale <- scale_fill_manual(name = "Var1",values = myColors)
g2<-ggplot(sum.canada, aes(x=Var1, y=Freq, fill=Var1)) +
geom_bar(stat='identity')+  guides(fill=FALSE) +
theme(axis.text.x = element_text(angle=0, vjust=0.5),
legend.position=c(0.8, 0.8),
legend.title=element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
labs(x="", y="", title="")+
colScale
grid.arrange(g1, g2, nrow=1)
canada<-subset(part1.view, Country=="Canada")
canada<-canada[!canada$view_change_of_type=="",]
change.view.ca<-data.frame(table(canada$view_change_of_type))
change.view.ca<-change.view.ca[!change.view.ca$Var1=="",]
change.view.ca$Var1<-droplevels(change.view.ca$Var1)
levels(change.view.ca$Var1)
# change order of the levels
change.view.ca$Var1<-factor(change.view.ca$Var1,
levels(change.view.ca$Var1)[c(5,3,1,2,4)])
myColors<-(brewer.pal(9, "Blues"))
myColors<-rev(myColors[c(9, 8,7,6,5)])
colScale <- scale_fill_manual(name = "Var1",values = myColors)
ggplot(change.view.ca, aes(x=Var1, y=Freq, fill=Var1)) + geom_bar(stat='identity')+
geom_text(aes(label=Freq, vjust=-1))+
guides(fill=FALSE)+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle=0, vjust=0.5)) +
labs(x="", y="No. of Responses") + colScale
canada<-subset(part2.view, Country=="Canada")
view<-data.frame(table(canada$view_change_partnership))
# change order of the levels
view$Var1<-factor(view$Var1, levels(view$Var1)[c(5,3,1,2,4)])
myColors<-(brewer.pal(9, "Blues"))
myColors<-rev(myColors[c(9, 8,7,6,5)])
colScale <- scale_fill_manual(name = "Var1",values = myColors)
ggplot(change.view.ca, aes(x=Var1, y=Freq, fill=Var1)) + geom_bar(stat='identity')+
geom_text(aes(label=Freq, vjust=-1))+
guides(fill=FALSE)+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle=0, vjust=0.5)) +
labs(x="", y="No. of Responses") + colScale
## make sure that Use-inspired is the middle level in the legend
res.plot<-subset(research, type%in%c("percent_fundemental_research_current",  "percent_Applied_Research_current" , "percent_Use_inspired_Research_current","percent_Applied_Research_past",  "percent_Fundamental_Research_past" , "percent_Use_inspired_Research_past"))
res.plot$percent<-str_replace_all(res.plot$percent, "%", "")
res.plot$percent<-as.numeric(as.character(res.plot$percent))
res.plot$type<-as.character(res.plot$type)
# add time variable
res.plot$time<-ifelse(grepl( "current", res.plot$type),"Current", "Past")
res.plot$type[res.plot$type=="percent_Applied_Research_past"]<-"Applied"
res.plot$type[res.plot$type=="percent_Applied_Research_current"]<-"Applied"
res.plot$type[res.plot$type=="percent_Fundamental_Research_past"]<-"Fundamental"
res.plot$type[res.plot$type=="percent_fundemental_research_current"]<-"Fundamental"
res.plot$type[res.plot$type=="percent_Use_inspired_Research_past"]<-"Use inspired"
res.plot$type[res.plot$type=="percent_Use_inspired_Research_current"]<-"Use inspired"
# change order of the levels
res.plot$time<-as.factor(res.plot$time)
res.plot$time<-factor(res.plot$time, levels(res.plot$time)[c(2,1)])
myColors<-(brewer.pal(9, "Blues"))
myColors<-myColors[c(9, 5)]
colScale <- scale_fill_manual(name = "time",values = myColors)
ggplot(res.plot[res.plot$Country=="Canada",], aes(percent, fill=time)) +
geom_histogram(position='dodge', binwidth=10, bins=seq(0, 100, 10))  +
guides(fill=guide_legend(title=NULL, reverse=FALSE, nrow=2)) +
labs(x="% funding", y="No. responses", title="")+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position=c(0.8, 0.2)) +
facet_wrap(~type, nrow=3) + colScale +
scale_x_continuous(breaks=seq(0,100,10))
ggplot(part, aes(x=Var1, y=Freq, fill = time)) +
geom_bar( stat='identity', position="dodge") +
geom_text(aes(label=Freq), position=position_dodge(width=1), vjust=-1) +
labs(x="", y="No. of Responses", fill="")+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle=0),
legend.position=c(0.9, 0.9),
legend.title=element_blank()) +
colScale
ggplot(change.view.ca, aes(x=Var1, y=Freq, fill=Var1)) + geom_bar(stat='identity')+
geom_text(aes(label=Freq, vjust=-1))+
guides(fill=FALSE)+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle=0, vjust=0.5)) +
labs(x="", y="No. of Responses") + colScale
myColors<-(brewer.pal(9, "Blues"))
myColors<-rev(myColors[c(9, 8,7,6,5)])
colScale <- scale_fill_manual(name = "Var1",values = myColors)
ggplot(change.view.ca, aes(x=Var1, y=Freq, fill=Var1)) + geom_bar(stat='identity')+
geom_text(aes(label=Freq, vjust=-1))+
guides(fill=FALSE)+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle=0, vjust=0.5)) +
labs(x="", y="No. of Responses") + colScale
canada<-subset(part2.view, Country=="Canada")
view<-data.frame(table(canada$view_change_partnership))
# change order of the levels
view$Var1<-factor(view$Var1, levels(view$Var1)[c(5,3,1,2,4)])
myColors<-(brewer.pal(9, "Blues"))
myColors<-rev(myColors[c(9, 8,7,6,5)])
colScale <- scale_fill_manual(name = "Var1",values = myColors)
ggplot(change.view.ca, aes(x=Var1, y=Freq, fill=Var1)) + geom_bar(stat='identity')+
geom_text(aes(label=Freq, vjust=-1))+
guides(fill=FALSE)+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle=0, vjust=0.5)) +
labs(x="", y="No. of Responses") + colScale
## make sure that Use-inspired is the middle level in the legend
res.plot<-subset(research, type%in%c("percent_fundemental_research_current",  "percent_Applied_Research_current" , "percent_Use_inspired_Research_current","percent_Applied_Research_past",  "percent_Fundamental_Research_past" , "percent_Use_inspired_Research_past"))
res.plot$percent<-str_replace_all(res.plot$percent, "%", "")
res.plot$percent<-as.numeric(as.character(res.plot$percent))
res.plot$type<-as.character(res.plot$type)
# add time variable
res.plot$time<-ifelse(grepl( "current", res.plot$type),"Current", "Past")
res.plot$type[res.plot$type=="percent_Applied_Research_past"]<-"Applied"
res.plot$type[res.plot$type=="percent_Applied_Research_current"]<-"Applied"
res.plot$type[res.plot$type=="percent_Fundamental_Research_past"]<-"Fundamental"
res.plot$type[res.plot$type=="percent_fundemental_research_current"]<-"Fundamental"
res.plot$type[res.plot$type=="percent_Use_inspired_Research_past"]<-"Use inspired"
res.plot$type[res.plot$type=="percent_Use_inspired_Research_current"]<-"Use inspired"
# change order of the levels
res.plot$time<-as.factor(res.plot$time)
res.plot$time<-factor(res.plot$time, levels(res.plot$time)[c(2,1)])
myColors<-(brewer.pal(9, "Blues"))
myColors<-myColors[c(9, 5)]
colScale <- scale_fill_manual(name = "time",values = myColors)
ggplot(res.plot[res.plot$Country=="Canada",], aes(percent, fill=time)) +
geom_histogram(position='dodge', binwidth=10, bins=seq(0, 100, 10))  +
guides(fill=guide_legend(title=NULL, reverse=FALSE, nrow=2)) +
labs(x="% funding", y="No. responses", title="")+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position=c(0.8, 0.2)) +
facet_wrap(~type, nrow=3) + colScale +
scale_x_continuous(breaks=seq(0,100,10))
## order bars from highest to lowest
# Change in the past 10 years? (yes, no, can't comment)
yes.no<-subset(research.change, select=c("Location","Country",  "gender", "changed_10yrs"))
canada<-subset(yes.no, Country=="Canada")
canada.yesno<-data.frame(table(canada$changed_10yrs))
canada.yesno<-canada.yesno[!canada.yesno$Var1=="",]
canada.yesno$Var1<-revalue(canada.yesno$Var1, c("Can't comment (new researcher)"="Can't comment"))
canada.yesno$Var1<-factor(canada.yesno$Var1, levels=c("Yes", "No", "Can't comment"))
myColors<-(brewer.pal(9, "Blues"))
myColors<-myColors[c(9, 7,5)]
colScale <- scale_fill_manual(name = "Var1",values = myColors)
g1<-ggplot(data=canada.yesno, aes(x=Var1, y=Freq, fill=Var1))+
geom_bar(stat='identity') +
guides(fill=FALSE) +
labs(x="", y="No. of responses",title="")+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) + colScale
## GRAPH PART 2
# What is your main reason for change?
reason<-subset(research.change, select=c("Location","Country",  "gender", "Main_reason_change_interest_related",
"Main_reason_change_Career_related", "Main_reason_change_Funding_related","Main_reason_change_Socially_related",
"Main_reason_change_Other"))
canada<-subset(reason, Country=="Canada")
## switch to long format
require(tidyr)
canada.long<-gather(canada, reason.change.ca, yes.ca, -Location, -gender, -Country)
## using table to count cases of each category
sum.canada<-data.frame(table(canada.long$reason.change.ca, canada.long$yes.ca))
sum.canada$Var1<-revalue(sum.canada$Var1, c("Main_reason_change_Career_related" = "Career", "Main_reason_change_Funding_related" = "Funding", "Main_reason_change_interest_related" = "Interest", "Main_reason_change_Other" = "Other", "Main_reason_change_Socially_related"  = "Social"))
sum.canada$Var1<-reorder(sum.canada$Var1, -sum.canada$Freq)
myColors<-(brewer.pal(9, "Blues"))
myColors<-myColors[c(9, 8,7,6,5)]
colScale <- scale_fill_manual(name = "Var1",values = myColors)
g2<-ggplot(sum.canada, aes(x=Var1, y=Freq, fill=Var1)) +
geom_bar(stat='identity')+  guides(fill=FALSE) +
theme(axis.text.x = element_text(angle=0, vjust=0.5),
legend.position=c(0.8, 0.8),
legend.title=element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
labs(x="", y="", title="")+
colScale
grid.arrange(g1, g2, nrow=1)
canada<-subset(part1.view, Country=="Canada")
canada<-canada[!canada$view_change_of_type=="",]
change.view.ca<-data.frame(table(canada$view_change_of_type))
change.view.ca<-change.view.ca[!change.view.ca$Var1=="",]
change.view.ca$Var1<-droplevels(change.view.ca$Var1)
levels(change.view.ca$Var1)
# change order of the levels
change.view.ca$Var1<-factor(change.view.ca$Var1,
levels(change.view.ca$Var1)[c(5,3,1,2,4)])
myColors<-(brewer.pal(9, "Blues"))
myColors<-rev(myColors[c(9, 8,7,6,5)])
colScale <- scale_fill_manual(name = "Var1",values = myColors)
ggplot(change.view.ca, aes(x=Var1, y=Freq, fill=Var1)) + geom_bar(stat='identity')+
geom_text(aes(label=Freq, vjust=-1))+
guides(fill=FALSE)+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle=0, vjust=0.5)) +
labs(x="", y="No. of Responses") + colScale
b.part<-data.frame(table(part2.b.a$partnership_outside_before))
b.part$time<-"Past"
a.part<-data.frame(table(part2.b.a$partnership_outside))
a.part$time<-"Current"
part<-rbind(a.part, b.part)
str(part)
part$Var1<-factor(part$Var1, levels(part$Var1)[c(1,4,3,2)])
myColors<-(brewer.pal(9, "Blues"))
myColors<-rev(myColors[c(9, 6)])
colScale <- scale_fill_manual(name = "Var1",values = myColors)
ggplot(part, aes(x=Var1, y=Freq, fill = time)) +
geom_bar( stat='identity', position="dodge") +
geom_text(aes(label=Freq), position=position_dodge(width=1), vjust=-1) +
labs(x="", y="No. of Responses", fill="")+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle=0),
legend.position=c(0.9, 0.9),
legend.title=element_blank()) +
colScale
### was there change
canada<-subset(part2.change, Country=="Canada")
change.part.ca<-data.frame(table(canada$partnership_change_10yrs))
change.part.ca$Var1<-revalue(change.part.ca$Var1, c("Can't comment (new researcher)"="Can't comment"))
change.part.ca$Var1<-factor(change.part.ca$Var1, levels=c("Yes", "No", "Can't comment"))
myColors<-(brewer.pal(9, "Blues"))
myColors<-myColors[c(9, 7,5)]
colScale <- scale_fill_manual(name = "Var1",values = myColors)
g1<-ggplot(data=change.part.ca, aes(x=Var1, y=Freq, fill=Var1))+
geom_bar(stat='identity') +
guides(fill=FALSE) +
labs(x="", y="No. of responses",title="")+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) + colScale
### reason
reason.pt.long<-gather(part2.reason, change.reason, yes, -Country, -gender, -Location)
sum.canada<-data.frame(table(reason.pt.long$change.reason, reason.pt.long$yes))
sum.canada$Var1<-revalue(sum.canada$Var1, c("reason_partnership_change_career" = "Career", "reason_partnership_change_funding" = "Funding", "reason_partnership_change_interest" = "Interest", "reason_partnership_change_other" = "Other", "reason_partnership_change_socially"  = "Social"))
sum.canada$Var1<-reorder(sum.canada$Var1, -sum.canada$Freq)
myColors<-(brewer.pal(9, "Blues"))
myColors<-myColors[c(9, 8,7,6,5)]
colScale <- scale_fill_manual(name = "Var1",values = myColors)
g2<-ggplot(sum.canada, aes(x=Var1, y=Freq, fill=Var1)) +
geom_bar(stat='identity')+  guides(fill=FALSE) +
theme(axis.text.x = element_text(angle=0, vjust=0.5),
legend.position=c(0.8, 0.8),
legend.title=element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
labs(x="", y="", title="")+
colScale
grid.arrange(g1, g2, nrow=1)
canada<-subset(part2.view, Country=="Canada")
view<-data.frame(table(canada$view_change_partnership))
# change order of the levels
view$Var1<-factor(view$Var1, levels(view$Var1)[c(5,3,1,2,4)])
myColors<-(brewer.pal(9, "Blues"))
myColors<-rev(myColors[c(9, 8,7,6,5)])
colScale <- scale_fill_manual(name = "Var1",values = myColors)
ggplot(change.view.ca, aes(x=Var1, y=Freq, fill=Var1)) + geom_bar(stat='identity')+
geom_text(aes(label=Freq, vjust=-1))+
guides(fill=FALSE)+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle=0, vjust=0.5)) +
labs(x="", y="No. of Responses") + colScale
canada<-subset(part3.grants.long, Country=="Canada")
canada$type.grant<-as.character(canada$type.grant)
canada$time<-ifelse(grepl("11_15", canada$type.grant), "2011-2015", "2006-2010")
canada$type.grant[canada$type.grant=="external_pi_grant_11_15_fundamental"]<-"Fundamental"
canada$type.grant[canada$type.grant=="external_pi_grant_6_10_fundamental"]<-"Fundamental"
canada$type.grant[canada$type.grant=="external_pi_grant_11_15_use"]<-"Use-Inspired"
canada$type.grant[canada$type.grant=="external_pi_grant_6_10_use"]<-"Use-Inspired"
canada$type.grant[canada$type.grant=="external_pi_grant_11_15_applied"]<-"Applied"
canada$type.grant[canada$type.grant=="external_pi_grant_6_10_applied"]<-"Applied"
head(canada)
grants.ca<-with, canada(table(type.grant,time,number)
grants.ca<-with(canada, table(type.grant,time,number))
grants.ca
grants.ca<-data.frame(with(canada, table(type.grant,time,number)))
grants.ca
levels(grants.ca$number)
#change order of levels
grants.ca$number<-factor(grants.ca$number, levels(grants.ca$number)[c(1,2,6,7,3,4,5)])
grants.ca$type.grant<-factor(grants.ca$type.grant, levels(grants.ca$type.grant)[c(2,3,1)])
ggplot(grants.ca, aes(type.grant, gender, fill=number)) + geom_bar(stat="identity", position = "dodge")+facet_wrap(~time) +guides(fill=guide_legend(title=NULL, reverse=FALSE)) +
labs(x="Number of grant applications", y="Number of responses")+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
ggplot(grants.ca, aes(type.grant, Freq, fill=number)) + geom_bar(stat="identity", position = "dodge")+facet_wrap(~time) +guides(fill=guide_legend(title=NULL, reverse=FALSE)) +
labs(x="Number of grant applications", y="Number of responses")+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
head(canada )
ggplot(grants.ca, aes(number, Freq, fill=time)) + geom_bar(stat="identity", position = "dodge")+facet_wrap(~type.grant) +guides(fill=guide_legend(title=NULL, reverse=FALSE)) +
labs(x="Number of grant applications", y="Number of responses")+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
```
ggplot(grants.ca, aes(number, Freq, fill=time)) + geom_bar(stat="identity", position = "dodge")+facet_wrap(~type.grant, nrow=3) +guides(fill=guide_legend(title=NULL, reverse=FALSE)) +
labs(x="Number of grant applications", y="Number of responses")+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
ggplot(grants.ca, aes(number, Freq, fill=time)) +
geom_bar(stat="identity", position = "dodge")+
facet_wrap(~type.grant, nrow=3) +
guides(fill=guide_legend(title=NULL, reverse=FALSE)) +
labs(x="No. of grant applications", y="No. of responses")+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
theme.position=c(0.8, 0.2)) + colScale
ggplot(grants.ca, aes(number, Freq, fill=time)) +
geom_bar(stat="identity", position = "dodge")+
facet_wrap(~type.grant, nrow=3) +
guides(fill=guide_legend(title=NULL, reverse=FALSE)) +
labs(x="No. of grant applications", y="No. of responses")+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position=c(0.8, 0.2)) + colScale
myColors<-(brewer.pal(9, "Blues"))
myColors<-rev(myColors[c(9, 5)])
colScale <- scale_fill_manual(name = "Var1",values = myColors)
ggplot(grants.ca, aes(number, Freq, fill=time)) +
geom_bar(stat="identity", position = "dodge")+
facet_wrap(~type.grant, nrow=3) +
guides(fill=guide_legend(title=NULL, reverse=FALSE)) +
labs(x="No. of grant applications", y="No. of responses")+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position=c(0.8, 0.2)) + colScale
canada<-subset(part3.success.long, Country=="Canada")
canada$type<-as.character(canada$type)
#add time variable
canada$time<-ifelse(grepl("11_15", canada$type), "2011-2015", "2006-2010")
canada$type[canada$type=="successful_grants_11_15_fundamental"]<-"Fundamental"
canada$type[canada$type=="successful_grants_6_10_fundamental"]<-"Fundamental"
canada$type[canada$type=="successful_grants_11_15_use"]<-"Use-Inspired"
canada$type[canada$type=="successful_grants_6_10_use"]<-"Use-Inspired"
canada$type[canada$type=="successful_grants_11_15_applied"]<-"Applied"
canada$type[canada$type=="successful_grants_6_10_applied"]<-"Applied"
success.ca<-aggregate(gender~type+percent+time, canada, length)
#change order of types
success.ca$type<-as.factor(success.ca$type)
success.ca$type<-factor(success.ca$type, levels(success.ca$type)[c(2,3,1)])
ggplot(success.ca, aes(percent, gender, fill=time))+geom_bar(stat="identity", position = "dodge")+facet_wrap(~type)+
guides(fill=guide_legend(title=NULL, reverse=FALSE)) +
labs(x="Percent of success", y="Number of responses")+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
```
success.ca<-with(canada, table(gender,type, percent,time))
head(success.ca)
success.ca<-with(canada, table(gender,type, percent,time))
head(success.ca)
canada<-subset(part3.success.long, Country=="Canada")
canada$type<-as.character(canada$type)
#add time variable
canada$time<-ifelse(grepl("11_15", canada$type), "2011-2015", "2006-2010")
canada$type[canada$type=="successful_grants_11_15_fundamental"]<-"Fundamental"
canada$type[canada$type=="successful_grants_6_10_fundamental"]<-"Fundamental"
canada$type[canada$type=="successful_grants_11_15_use"]<-"Use-Inspired"
canada$type[canada$type=="successful_grants_6_10_use"]<-"Use-Inspired"
canada$type[canada$type=="successful_grants_11_15_applied"]<-"Applied"
canada$type[canada$type=="successful_grants_6_10_applied"]<-"Applied"
success.ca<-with(canada, table(gender,type, percent,time))
head(succes.ca)
head(success.ca)
head(canada)
success.ca<-with(canada, table(type, percent,time))
head(success.ca)
success.ca<-data.frame(with(canada, table(type, percent,time)))
head(success.ca)
success.ca$type<-as.factor(success.ca$type)
levels(success.ca$type)
success.ca$type<-factor(success.ca$type, levels(success.ca$type)[c(2,3,1)])
myColors<-(brewer.pal(9, "Blues"))
myColors<-rev(myColors[c(9, 5)])
colScale <- scale_fill_manual(name = "Var1",values = myColors)
ggplot(grants.ca, aes(percent, Freq, fill=time)) +
geom_bar(stat="identity", position = "dodge")+
facet_wrap(~type.grant, nrow=3) +
guides(fill=guide_legend(title=NULL, reverse=FALSE)) +
labs(x="No. of grant applications", y="No. of responses")+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position=c(0.8, 0.2)) + colScale
colScale <- scale_fill_manual(name = "time",values = myColors)
ggplot(success.ca, aes(percent, Freq, fill=time)) +
geom_bar(stat="identity", position = "dodge")+
facet_wrap(~type.grant, nrow=3) +
guides(fill=guide_legend(title=NULL, reverse=FALSE)) +
labs(x="No. of grant applications", y="No. of responses")+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position=c(0.8, 0.2)) + colScale
head(success.ca)
ggplot(success.ca, aes(percent, Freq, fill=time)) +
geom_bar(stat="identity", position = "dodge")+
facet_wrap(~type, nrow=3) +
guides(fill=guide_legend(title=NULL, reverse=FALSE)) +
labs(x="No. of grant applications", y="No. of responses")+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position=c(0.8, 0.2)) + colScale
ggplot(success.ca, aes(percent, Freq, fill=time)) +
geom_bar(stat="identity", position = "dodge")+
facet_wrap(~type, nrow=3) +
guides(fill=guide_legend(title=NULL, reverse=FALSE)) +
labs(x="% successful grants", y="No. of responses")+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position=c(0.8, 0.2)) + colScale
canada<-subset(part2.change, Country=="Canada")
change.part.ca<-data.frame(table(canada$partnership_change_10yrs))
change.part.ca$Var1<-revalue(change.part.ca$Var1, c("Can't comment (new researcher)"="Can't comment"))
change.part.ca$Var1<-factor(change.part.ca$Var1, levels=c("Yes", "No", "Can't comment"))
myColors<-(brewer.pal(9, "Blues"))
myColors<-myColors[c(9, 7,5)]
colScale <- scale_fill_manual(name = "Var1",values = myColors)
g1<-ggplot(data=change.part.ca, aes(x=Var1, y=Freq, fill=Var1))+
geom_bar(stat='identity') +
guides(fill=FALSE) +
labs(x="", y="No. of responses",title="")+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) + colScale
### reason
reason.pt.long<-gather(part2.reason, change.reason, yes, -Country, -gender, -Location)
sum.canada<-data.frame(table(reason.pt.long$change.reason, reason.pt.long$yes))
sum.canada$Var1<-revalue(sum.canada$Var1, c("reason_partnership_change_career" = "Career", "reason_partnership_change_funding" = "Funding", "reason_partnership_change_interest" = "Interest", "reason_partnership_change_other" = "Other", "reason_partnership_change_socially"  = "Social"))
sum.canada$Var1<-reorder(sum.canada$Var1, -sum.canada$Freq)
myColors<-(brewer.pal(9, "Blues"))
myColors<-myColors[c(9, 8,7,6,5)]
colScale <- scale_fill_manual(name = "Var1",values = myColors)
g2<-ggplot(sum.canada, aes(x=Var1, y=Freq, fill=Var1)) +
geom_bar(stat='identity')+  guides(fill=FALSE) +
theme(axis.text.x = element_text(angle=0, vjust=0.5),
legend.position=c(0.8, 0.8),
legend.title=element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
labs(x="", y="", title="")+
colScale
grid.arrange(g1, g2, nrow=1)
colScale <- scale_fill_manual(name = "Var1",values = myColors)
myColors<-(brewer.pal(9, "Blues"))
myColors<-myColors[c(9, 7,5)]
colScale <- scale_fill_manual(name = "Var1",values = myColors)
g1
g2
sum.canada
levels(sum.canada$Var1)
grid.arrange(g1, g2, nrow=1)
install.packages('pdflatex')
