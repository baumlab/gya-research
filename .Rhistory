grants$number<-factor(grants$number, levels(grants$number)[c(1,2,6,7,3,4,5)])
grants$type.grant<-factor(grants$type.grant, levels(grants$type.grant)[c(2,3,1)])
ggplot(grants, aes(type.grant, gender, fill=number)) + geom_bar(stat="identity", position = "dodge")+facet_wrap(~time) +guides(fill=guide_legend(title=NULL, reverse=FALSE)) +
labs(x="Number of grant applications", y="Number of responses")+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
## 17b  canada
canada<-subset(part3.grants.long, Country=="Canada")
canada$type.grant<-as.character(canada$type.grant)
#add time variable
canada$time<-ifelse(grepl("11_15", canada$type.grant), "2011-2015", "2006-2010")
canada$type.grant[canada$type.grant=="external_pi_grant_11_15_fundamental"]<-"Fundamental"
canada$type.grant[canada$type.grant=="external_pi_grant_6_10_fundamental"]<-"Fundamental"
canada$type.grant[canada$type.grant=="external_pi_grant_11_15_use"]<-"Use-Inspired"
canada$type.grant[canada$type.grant=="external_pi_grant_6_10_use"]<-"Use-Inspired"
canada$type.grant[canada$type.grant=="external_pi_grant_11_15_applied"]<-"Applied"
canada$type.grant[canada$type.grant=="external_pi_grant_6_10_applied"]<-"Applied"
grants.ca<-aggregate(gender~ type.grant+time+number, canada, length)
grants.ca$type.grant<-as.factor(grants.ca$type.grant)
#change order of levels
grants.ca$number<-factor(grants.ca$number, levels(grants.ca$number)[c(1,2,6,7,3,4,5)])
grants.ca$type.grant<-factor(grants.ca$type.grant, levels(grants.ca$type.grant)[c(2,3,1)])
ggplot(grants.ca, aes(type.grant, gender, fill=number)) + geom_bar(stat="identity", position = "dodge")+facet_wrap(~time) +guides(fill=guide_legend(title=NULL, reverse=FALSE)) +
labs(x="Number of grant applications", y="Number of responses")+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
#### 18a percent of applications successful
part3.success.long$type<-as.character(part3.success.long$type)
#add time variable
part3.success.long$time<-ifelse(grepl("11_15", part3.success.long$type), "2011-2015", "2006-2010")
part3.success.long$type[part3.success.long$type=="successful_grants_11_15_fundamental"]<-"Fundamental"
part3.success.long$type[part3.success.long$type=="successful_grants_6_10_fundamental"]<-"Fundamental"
part3.success.long$type[part3.success.long$type=="successful_grants_11_15_use"]<-"Use-Inspired"
part3.success.long$type[part3.success.long$type=="successful_grants_6_10_use"]<-"Use-Inspired"
part3.success.long$type[part3.success.long$type=="successful_grants_11_15_applied"]<-"Applied"
part3.success.long$type[part3.success.long$type=="successful_grants_6_10_applied"]<-"Applied"
success<-aggregate(gender~type+percent+time, part3.success.long, length)
#change order of types
success$type<-as.factor(success$type)
success$type<-factor(success$type, levels(success$type)[c(2,3,1)])
ggplot(success, aes(percent, gender, fill=time))+geom_bar(stat="identity", position = "dodge")+facet_wrap(~type)+
guides(fill=guide_legend(title=NULL, reverse=FALSE)) +
labs(x="Percent of success", y="Number of responses")+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
## 18b canada
canada<-subset(part3.success.long, Country=="Canada")
canada$type<-as.character(canada$type)
#add time variable
canada$time<-ifelse(grepl("11_15", canada$type), "2011-2015", "2006-2010")
canada$type[canada$type=="successful_grants_11_15_fundamental"]<-"Fundamental"
canada$type[canada$type=="successful_grants_6_10_fundamental"]<-"Fundamental"
canada$type[canada$type=="successful_grants_11_15_use"]<-"Use-Inspired"
canada$type[canada$type=="successful_grants_6_10_use"]<-"Use-Inspired"
canada$type[canada$type=="successful_grants_11_15_applied"]<-"Applied"
canada$type[canada$type=="successful_grants_6_10_applied"]<-"Applied"
success.ca<-aggregate(gender~type+percent+time, canada, length)
#change order of types
success.ca$type<-as.factor(success.ca$type)
success.ca$type<-factor(success.ca$type, levels(success.ca$type)[c(2,3,1)])
ggplot(success.ca, aes(percent, gender, fill=time))+geom_bar(stat="identity", position = "dodge")+facet_wrap(~type)+
guides(fill=guide_legend(title=NULL, reverse=FALSE)) +
labs(x="Percent of success", y="Number of responses")+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
#### 19a suggesting practical applications
part3.prac.long$year<-as.character(part3.prac.long$year)
part3.prac.long$year[part3.prac.long$year=="practical_applications_important_11_15"]<-"2011-2015"
part3.prac.long$year[part3.prac.long$year=="practical_applications_important_6_10"]<-"2006-2010"
prac<-aggregate(gender~year+level, part3.prac.long, length)
#change order of levels
prac$level<-factor(prac$level, levels(prac$level)[c(2,6,4,5,3,1)])
ggplot(prac, aes(level, gender, fill=year))+ geom_bar(stat="identity", position = "dodge")+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
guides(fill=guide_legend(title=NULL, reverse=FALSE)) + labs(x="", y="Number of responses")+theme(axis.text.x = element_text(angle=90, vjust=0.5))
## 19b Canada
canada<-subset(part3.prac.long, Country=="Canada")
canada$year<-as.character(canada$year)
canada$year[canada$year=="practical_applications_important_11_15"]<-"2011-2015"
canada$year[canada$year=="practical_applications_important_6_10"]<-"2006-2010"
prac.ca<-aggregate(gender~year+level, canada, length)
#change order of levels
prac.ca$level<-factor(prac.ca$level, levels(prac.ca$level)[c(2,6,4,5,3,1)])
ggplot(prac.ca, aes(level, gender, fill=year))+ geom_bar(stat="identity", position = "dodge")+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
guides(fill=guide_legend(title=NULL, reverse=FALSE)) + labs(x="", y="Number of responses")+theme(axis.text.x = element_text(angle=90, vjust=0.5))
#####20a include partners from for profit or non gov sectors
part3.part.long$year<-as.character(part3.part.long$year)
part3.part.long$year[part3.part.long$year=="include_nonacademia_partners_success_11_15"]<-"2011-2015"
part3.part.long$year[part3.part.long$year=="include_nonacademia_partners_success_6_10"]<-"2006-2010"
head(part3.part.long)
partner<-aggregate(gender~year+level, part3.part.long, length)
#change order of levels
partner$level<-factor(partner$level, levels(partner$level)[c(2,5,6,4,3,1)])
ggplot(partner, aes(level, gender, fill=year))+ geom_bar(stat="identity", position = "dodge")+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
guides(fill=guide_legend(title=NULL, reverse=FALSE)) + labs(x="", y="Number of responses")+theme(axis.text.x = element_text(angle=90, vjust=0.5))
## 20b Canada
canada<-subset(part3.part.long, Country=="Canada")
canada$year<-as.character(canada$year)
canada$year[canada$year=="include_nonacademia_partners_success_11_15"]<-"2011-2015"
canada$year[canada$year=="include_nonacademia_partners_success_6_10"]<-"2006-2010"
part.ca<-aggregate(gender~year+level, canada, length)
#change order of levels
part.ca$level<-factor(part.ca$level, levels(part.ca$level)[c(2,5,6,4,3,1)])
ggplot(part.ca, aes(level, gender, fill=year))+ geom_bar(stat="identity", position = "dodge")+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
guides(fill=guide_legend(title=NULL, reverse=FALSE)) + labs(x="", y="Number of responses")+theme(axis.text.x = element_text(angle=90, vjust=0.5))
#### 21a distribution of funding
head(p3_master.long)
ggplot(p3_master.long, aes(percent, fill=year))+ geom_histogram(position='dodge', binwidth=25)  +  facet_wrap(~type)
## 21b
canada<-subset(p3_master.long, Country=="Canada")
ggplot(canada, aes(percent, fill=year))+ geom_histogram(position='dodge', binwidth=25)  +  facet_wrap(~type)
## grant success rates change in last 10 yrs
head(part3.change)
require(tidyr)
change.long<-gather(part3.change, type, level, -Location, -gender, -Country, -what_participant_group, -field_research, -Country_work)
head(change.long)
change<-aggregate(gender~type+level, change.long, length)
# remove non-response
change<-change[!change$level=="",]
ggplot(data=change, aes(x=level, gender, fill=type))+ geom_bar(stat='identity', position = "dodge") +
theme(axis.text.x = element_text(angle=90, vjust=0.5))
## Canada  by gender
canada<-subset(part3.change, Country=="Canada")
require(tidyr)
change.long.ca<-gather(canada, type, level, -Location, -gender, -Country, -what_participant_group, -field_research, -Country_work)
head(change.long.ca)
gender.change<-aggregate(Location~type+gender+level, change.long.ca, length)
head(gender.change)
#remove no response
gender.change<-gender.change[!gender.change$gender=="",]
gender.change<-gender.change[!gender.change$level=="",]
# turn to percents
male<-subset(gender.change, gender=="Male")
female<-subset(gender.change, gender=="Female")
other<-subset(gender.change, gender=="Other")
gender.change$Location<-ifelse(gender.change$gender=="Male", (gender.change$Location/sum(male$Location))*100, gender.change$Location)
gender.change$Location<-ifelse(gender.change$gender=="Female", (gender.change$Location/sum(female$Location))*100, gender.change$Location)
gender.change$Location<-ifelse(gender.change$gender=="Other", (gender.change$Location/sum(other$Location))*100, gender.change$Location)
str(gender.change)
# change type to factor with levels
gender.change$type<-as.factor(gender.change$type)
gender.change$level<-str_replace_all(gender.change$level, "Will", "")
gender.change$level<-as.factor(gender.change$level)
#change order of levels
gender.change$level<-factor(gender.change$level, levels(gender.change$level)[c(1,3,2,6,4,5)])
gender.change$type<-factor(gender.change$type, levels(gender.change$type)[c(2,3,1)])
ggplot(data=gender.change, aes(x=level, Location, fill=type))+geom_bar(stat="identity", position="dodge")+ scale_x_discrete(limits = rev(levels(gender.change$level)))+
facet_wrap(~gender)+theme(axis.text.x = element_text(angle=90, vjust=0.5))+labs(x="", y="Percentage of responses", fill="")+
scale_fill_discrete(labels=c("Fundamental", "Use-inspired", "Applied")) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
dev.off()
## Script to examine gender differences in survey questions
## CHANGE WORKING DIRECTORY FOR YOUR LOCAL MACHINE BEFORE KNITTING ##
setwd("/Users/kristinatietjen/Documents/git_hub/gya-research")
#setwd("/Users/IMAC3/Documents/git-jpwrobinson/gya-research")
#setwd("/Users/jpwrobinson/Documents/git_repos/gya-research")
#setwd("/Users/Julia_2013MacBookAir/Desktop/GitRepos/gya-research")
## load in survey data
survey<-read.csv(file="data/gya-without-incomplete.csv")
survey.what<-read.csv(file="data/gya-country-responses.csv")
research<-read.csv(file="data/gya-surveys-cleaned-research.csv")
research.change<-read.csv(file="data/gya-change-reason.csv")
part4<-read.csv(file="data/gya-survey-part4.csv")
part2.b.a<-read.csv(file="data/gya-part2.before.after.csv")
part2.change<-read.csv(file="data/gya-part2.change.csv")
part2.reason<-read.csv(file="data/gya-part2.reason.csv")
part2.view<-read.csv(file="data/gya-part2.view.csv")
part1.view<-read.csv(file="data/gya-part1.view.csv")
part3.grants.long<-read.csv(file="data/gya-part3.grants.long.csv")
part3.change<-read.csv(file="data/gya-part3.change.csv")
part3.success.long<-read.csv(file="data/gya-part3.success.long.csv")
part3.prac.long<-read.csv(file="data/gya-part3.prac.long.csv")
part3.part.long<-read.csv(file="data/gya-part3.part.long.csv")
p3_master.long<-read.csv(file="data/gya-p3_master.long.csv")
p3_master<-read.csv(file="data/gya-p3_master.csv")
## load required packages
require(gridExtra); require(tidyr); require(ggplot2); require(stringr);require(RColorBrewer); require(colorRamps); require(plotrix); require(plyr); require(visreg)
theme_set(theme_bw())
#--------------------#--------------------#--------------------
#### Part1. Question 2. Proportions of type of research change
#--------------------#--------------------#--------------------
change<-subset(research.change, select=c("Location","Country",'Country_work', "gender", "changed_10yrs"))
canada<-change[change$Country_work=="Canada" | (!(change$Country_work=="Canada") &
change$Country_work=="" & change$Country=="Canada"),]
canada<-canada[!canada$gender=="Other",]
canada<-canada[!canada$gender=="",]
canada<-canada[!canada$changed_10yrs=="",]
canada<-droplevels(canada)
## using table to count cases of each category
sum.change<-data.frame(table(canada$changed_10yrs, canada$gender))
sum.change
# turn to percents  ????????
male<-subset(sum.change, Var2=="Male")
female<-subset(sum.change, Var2=="Female")
sum.change$Freq<-ifelse(sum.change$Var2=='Male',(sum.change$Freq/sum(male$Freq))*100, sum.change$Freq)
sum.change$Freq<-ifelse(sum.change$Var2=='Female',(sum.change$Freq/sum(female$Freq))*100, sum.change$Freq)
change.mod1<-(glm(Freq ~ Var1*Var2, sum.change, family="poisson"))
change.mod2<-(glm(Freq ~ Var1 +Var2, sum.change, family="poisson"))
visreg(change.mod1, "Var2",by="Var1", scale="response", ylab="Number of responses", xlab="Gender")
summary(change.mod1)
head(change.mod2)
anova(change.mod1, change.mod2, test="Chi")
#--------------------#--------------------#--------------------
#### Part1. Question 1 & 3. Proportions of type of research current and past
#--------------------#--------------------#--------------------
#--------------------#--------------------#--------------------
#### Part1. Question 4. Reason for change
#--------------------#--------------------#--------------------
#--------------------#--------------------#--------------------
#### Part1. Question 5. View of change
#--------------------#--------------------#--------------------
#--------------------#--------------------#--------------------
#### Part2. Question 1 & 3. Level of partnership outside academia -current and before
#--------------------#--------------------#--------------------
#--------------------#--------------------#--------------------
#### Part2. Question 2. Level of partnership outside academia -change
#--------------------#--------------------#--------------------
#--------------------#--------------------#--------------------
#### Part2. Question 4. Reason for change
#--------------------#--------------------#--------------------
#--------------------#--------------------#--------------------
#### Part2. Question 5. View of change
#--------------------#--------------------#--------------------
#--------------------#--------------------#--------------------
#### Part3. Question 1. Grant apps types 2006-2010, 2011-2015
#--------------------#--------------------#--------------------
#--------------------#--------------------#--------------------
#### Part3. Question 2. Successful grant apps types 2006-2010, 2011-2015
#--------------------#--------------------#--------------------
#--------------------#--------------------#--------------------
#### Part3. Question 3. Importance of suggesting practical applications 2006-2010, 2011-2015
#--------------------#--------------------#--------------------
#--------------------#--------------------#--------------------
#### Part3. Question 4. Importance of having partners 2006-2010, 2011-2015
#--------------------#--------------------#--------------------
#--------------------#--------------------#--------------------
#### Part3. Question 5. Distribution of funding 2006-2010, 2011-2015
#--------------------#--------------------#--------------------
#--------------------#--------------------#--------------------
#### Part3. Question 6. Success rate change for types 2006-2010, 2011-2015
#--------------------#--------------------#--------------------
#--------------------#--------------------#--------------------
#### Part4. Question 1. Research priority - fundamental
#--------------------#--------------------#--------------------
## order bars from very important (left) to can't comment (right)
important<-subset(part4, select=c("Location","Country",'Country_work', "gender","opinion_fundamental_important"))
canada<-important[important$Country_work=="Canada" | (!(important$Country_work=="Canada") & important$Country_work=="" & important$Country=="Canada"),]
canada<-canada[!canada$opinion_fundamental_important=="",]
canada<-canada[!canada$gender=="Other",]
canada$opinion_fundamental_important<-factor(canada$opinion_fundamental_important, levels(canada$opinion_fundamental_important)[c(6,5,4,3,2,1)])
canada<-droplevels(canada)
head(canada)
## using table to count cases of each category
sum.important<-data.frame(table(canada$opinion_fundamental_important, canada$gender))
# remove non-responses
#sum.important<-sum.important[!sum.important$Var2=="",]
#sum.important<-sum.important[!sum.important$Var1=="",]
sum.important<-sum.important[!sum.important$Var2=="Other",]
sum.important<-sum.important[!sum.important$Var2=="",]
head(sum.important)
#perceive<-aggregate(Freq~Var1, sum.important, sum)
temp<-with(canada, table(opinion_fundamental_important, gender))
chisq.test(temp)
?visreg
priority.mod1<-(glm(Freq ~ Var1*Var2, sum.important, family="poisson"))
priority.mod2<-(glm(Freq ~ Var1 +Var2, sum.important, family="poisson"))
visreg(priority.mod1, "Var2",by="Var1", scale="response", ylab="Number of responses", xlab="Gender")
summary(priority.mod1)
head(priority.mod2)
anova(priority.mod1, priority.mod2, test="Chi")
#--------------------#--------------------#--------------------
#### Part4. Question 2. Change in research priority
#--------------------#--------------------#--------------------
## order bars into applied > use > fundamental > no change
priority<-subset(part4, select=c("Location","Country",'Country_work', "gender", "high_priority_fundamental", "high_priority_use_inspired", "high_priority_applied",
"high_priority_no_change"))
canada<-priority[priority$Country_work=="Canada" | (!(priority$Country_work=="Canada") & priority$Country_work=="" & priority$Country=="Canada"),]
## switch to long format
priority.long<-gather(canada, what.type, higher.priority, -Location, -gender, -Country, -Country_work)
# remove non-responses (n = 1066)
#dim(priority.long[!priority.long$higher.priority=="",])/4
priority.long<-priority.long[!is.na(priority.long$higher.priority),]
#per.change<-aggregate(higher.priority~what.type +gender, priority.long, sum)
gender.perceive<-data.frame(table( priority.long$gender , priority.long$what.type))
# turn to percents
male<-subset(gender.perceive, Var1=="Male")
female<-subset(gender.perceive, Var1=="Female")
other<-subset(gender.perceive, Var1=="Other")
gender.perceive$Freq<-ifelse(gender.perceive$Var1=='Male',(gender.perceive$Freq/sum(male$Freq))*100, gender.perceive$Freq)
gender.perceive$Freq<-ifelse(gender.perceive$Var1=='Female',(gender.perceive$Freq/sum(female$Freq))*100, gender.perceive$Freq)
gender.perceive$Freq<-ifelse(gender.perceive$Var1=='Other',(gender.perceive$Freq/sum(other$Freq))*100, gender.perceive$Freq)
# change order of the levels
gender.perceive<-gender.perceive[!(gender.perceive$Var1=="Other" | gender.perceive$Var1==""),]
#gender.perceive$what.type<-factor(gender.perceive$what.type, levels(gender.perceive$what.type)[c(2,4,1,3)])
gender.perceive$Var2<-revalue(gender.perceive$Var2, c("high_priority_fundamental"="Fundamental",
'high_priority_use_inspired'='Use-inspired', 'high_priority_applied' = 'Applied',
'high_priority_no_change'="No change"))
priority.mod<-(glm(Freq ~ Var1*Var2, gender.perceive, family="poisson"))
visreg(priority.mod, "Var2",by="Var1", scale="response", ylab="No. of responses (scaled by gender)", xlab="Gender")
priority.mod1<-(glm(Freq ~ Var1*Var2, gender.perceive, family="poisson"))
priority.mod2<-(glm(Freq ~ Var1 +Var2, gender.perceive, family="poisson"))
visreg(priority.mod1, "Var2",by="Var1", scale="response", ylab="Number of responses", xlab="Gender")
summary(priority.mod1)
anova(priority.mod1, priority.mod2, test="Chi")
#--------------------#--------------------#--------------------
#### Part4. Question 3. Change in research funding
#--------------------#--------------------#--------------------
availability.change<-subset(part4, select=c("Location", "Country",'Country_work', "gender", "available_funding_fundamental",
"available_funding_use_inspired", "available_funding_applied"))
canada<-availability.change[availability.change$Country_work=="Canada" | (!(availability.change$Country_work=="Canada") & availability.change$Country_work=="" & availability.change$Country=="Canada"),]
## switch to long format
availability.change.long.ca<-gather(canada, what.type, level, -gender, -Location, -Country, -Country_work)
availability.ca<-with(availability.change.long.ca, data.frame(table(what.type, level)))
#remove non response
availability.ca<-availability.ca[!availability.ca$level=="",]
#gender.perceive<-aggregate(Location ~ what.type + gender+level, availability.change.long.ca, length)
#availability.ca<-aggregate(gender~what.type+level, availability.change.long.ca,length)
# remove non-response
#gender.perceive<-gender.perceive[!gender.perceive$level=="",]
#gender.perceive<-gender.perceive[!gender.perceive$gender=="",]
# turn to percents
#male<-subset(gender.perceive, gender=="Male")
#female<-subset(gender.perceive, gender=="Female")
#other<-subset(gender.perceive, gender=="Other")
#gender.perceive$Location<-ifelse(gender.perceive$gender=='Male',(gender.perceive$Location/sum(male$Location))*100, gender.perceive$Location)
#gender.perceive$Location<-ifelse(gender.perceive$gender=='Female',(gender.perceive$Location/sum(female$Location))*100, gender.perceive$Location)
#gender.perceive$Location<-ifelse(gender.perceive$gender=='Other',(gender.perceive$Location/sum(other$Location))*100, gender.perceive$Location)
## change type to factor with levels
availability.ca$level<-str_replace_all(availability.ca$level, "Will ", "")
availability.ca$what.type<-as.factor(availability.ca$what.type)
availability.ca$level<-as.factor(availability.ca$level)
## change order of levels
availability.ca$level<-factor(availability.ca$level, levels(availability.ca$level)[c(4,5,6,3,2,1 )])
availability.ca$what.type<-factor(availability.ca$what.type, levels(availability.ca$what.type)[c(2,3,1)])
availability.ca$what.type<-revalue(availability.ca$what.type, c("available_funding_fundamental"="Fundamental",
'available_funding_use_inspired'='Use-inspired', 'available_funding_applied' = 'Applied'))
#--------------------#--------------------#--------------------
#### Part4. Question 4. Research - next generation
#--------------------#--------------------#--------------------
## order bars into increase considerably (left) to decrease considerably (right), then no comment at the far right
next.generation<-subset(part4, select=c("Location", "Country","Country_work", "gender","next_generation"))
# remove non-response
next.generation<-next.generation[!next.generation$next_generation=="",]
canada<-next.generation[next.generation$Country_work=="Canada" | (!(next.generation$Country_work=="Canada") & next.generation$Country_work=="" & next.generation$Country=="Canada"),]
impact<-data.frame(table(canada$next_generation))
## change type to factor with levels
impact$Var1<-str_replace_all(impact$Var1, "Will ", "")
impact$Var1<-as.factor(impact$Var1)
impact<-impact[!impact$Var1=="",]
## change order of Var1s
impact$Var1<-factor(impact$Var1, levels(impact$Var1)[c(4,5,6,3,2,1)])
impact<-droplevels(impact)
# CHANGE WORKING DIRECTORY FOR YOUR LOCAL MACHINE BEFORE KNITTING ##
setwd("/Users/kristinatietjen/Documents/git_hub/gya-research")
#setwd("/Users/IMAC3/Documents/git-jpwrobinson/gya-research")
#setwd("/Users/jpwrobinson/Documents/git_repos/gya-research")
#setwd("/Users/Julia_2013MacBookAir/Desktop/GitRepos/gya-research")
## load in survey data
survey<-read.csv(file="data/gya-without-incomplete.csv")
survey.what<-read.csv(file="data/gya-country-responses.csv")
research<-read.csv(file="data/gya-surveys-cleaned-research.csv")
research.change<-read.csv(file="data/gya-change-reason.csv")
part4<-read.csv(file="data/gya-survey-part4.csv")
part2.b.a<-read.csv(file="data/gya-part2.before.after.csv")
part2.change<-read.csv(file="data/gya-part2.change.csv")
part2.reason<-read.csv(file="data/gya-part2.reason.csv")
part2.view<-read.csv(file="data/gya-part2.view.csv")
part1.view<-read.csv(file="data/gya-part1.view.csv")
part3.grants.long<-read.csv(file="data/gya-part3.grants.long.csv")
part3.change<-read.csv(file="data/gya-part3.change.csv")
part3.success.long<-read.csv(file="data/gya-part3.success.long.csv")
part3.prac.long<-read.csv(file="data/gya-part3.prac.long.csv")
part3.part.long<-read.csv(file="data/gya-part3.part.long.csv")
p3_master.long<-read.csv(file="data/gya-p3_master.long.csv")
p3_master<-read.csv(file="data/gya-p3_master.csv")
## load required packages
require(gridExtra); require(tidyr); require(ggplot2); require(stringr);require(RColorBrewer); require(colorRamps); require(plotrix); require(plyr); require(visreg)
theme_set(theme_bw())
change<-subset(research.change, select=c("Location","Country",'Country_work', "gender","what_participant_group", "field_research", "changed_10yrs"))
canada<-change[change$Country_work=="Canada" | (!(change$Country_work=="Canada") &
change$Country_work=="" & change$Country=="Canada"),]
canada<-canada[!canada$gender=="Other",]
canada<-canada[!canada$gender=="",]
canada<-canada[!canada$changed_10yrs=="",]
canada<-droplevels(canada)
sum.change<-data.frame(table(canada$changed_10yrs, canada$field_research))
sum.change
change.mod1<-(glm(Freq ~ Var1*Var2, sum.change, family="poisson"))
change.mod2<-(glm(Freq ~ Var1 +Var2, sum.change, family="poisson"))
visreg(change.mod1, "Var2",by="Var1", scale="response", ylab="Number of responses", xlab="Gender")
summary(change.mod1)
head(change.mod2)
anova(change.mod1, change.mod2, test="Chi")
engineering<-subset(sum.change, Var2=="Engineering")
change<-subset(research.change, select=c("Location","Country",'Country_work', "gender","what_participant_group", "field_research", "changed_10yrs"))
canada<-change[change$Country_work=="Canada" | (!(change$Country_work=="Canada") &
change$Country_work=="" & change$Country=="Canada"),]
canada<-canada[!canada$gender=="Other",]
canada<-canada[!canada$gender=="",]
canada<-canada[!canada$changed_10yrs=="",]
canada<-droplevels(canada)
## using table to count cases of each category
sum.change<-data.frame(table(canada$changed_10yrs, canada$field_research))
sum.change
# turn to percents  ????????
engineering<-subset(sum.change, Var2=="Engineering")
inter.sci<-subset(sum.change, Var2=="Interdisciplinary Science")
nat.sci<-subset(sum.change, Var2=="Natural Science")
other<-subset(sum.change, Var2=="Other")
phys.sci<-subset(sum.change, Var2=="Physical Science (eg. math, physics, chemistry, computer science)")
soc.sci<-subset(sum.change, Var2=="Social Science / Humanities")
sum.change$Freq<-ifelse(sum.change$Var2=='Engineering',(sum.change$Freq/sum(engineering$Freq))*100, sum.change$Freq)
sum.change$Freq<-ifelse(sum.change$Var2=='Interdisciplinary Science',(sum.change$Freq/sum(inter.sci$Freq))*100, sum.change$Freq)
sum.change$Freq<-ifelse(sum.change$Var2=='Natural Science',(sum.change$Freq/sum(nat.sci$Freq))*100, sum.change$Freq)
sum.change$Freq<-ifelse(sum.change$Var2=='Other',(sum.change$Freq/sum(other$Freq))*100, sum.change$Freq)
sum.change$Freq<-ifelse(sum.change$Var2=='Physical Science (eg. math, physics, chemistry, computer science)',(sum.change$Freq/sum(phys.sci$Freq))*100, sum.change$Freq)
sum.change$Freq<-ifelse(sum.change$Var2=='Social Science / Humanities',(sum.change$Freq/sum(soc.sci$Freq))*100, sum.change$Freq)
change.mod1<-(glm(Freq ~ Var1*Var2, sum.change, family="poisson"))
head(sum.change)
change.mod1<-(glm(Freq ~ Var1*Var2, sum.change, family="poisson"))
warnings(17)
change.mod2<-(glm(Freq ~ Var1 +Var2, sum.change, family="poisson"))
visreg(change.mod1, "Var2",by="Var1", scale="response", ylab="Number of responses", xlab="Gender")
summary(change.mod1)
head(change.mod2)
anova(change.mod1, change.mod2, test="Chi")
change<-subset(research.change, select=c("Location","Country",'Country_work', "gender","what_participant_group", "field_research", "changed_10yrs"))
canada<-change[change$Country_work=="Canada" | (!(change$Country_work=="Canada") &
change$Country_work=="" & change$Country=="Canada"),]
canada<-canada[!canada$gender=="Other",]
canada<-canada[!canada$gender=="",]
canada<-canada[!canada$changed_10yrs=="",]
canada<-droplevels(canada)
## using table to count cases of each category
sum.change<-data.frame(table(canada$changed_10yrs, canada$field_research))
sum.change
change.mod1<-(glm(Freq ~ Var1*Var2, sum.change, family="poisson"))
change.mod2<-(glm(Freq ~ Var1 +Var2, sum.change, family="poisson"))
visreg(change.mod1, "Var2",by="Var1", scale="response", ylab="Number of responses", xlab="Gender")
summary(change.mod1)
head(change.mod2)
anova(change.mod1, change.mod2, test="Chi")
important<-subset(part4, select=c("Location","Country",'Country_work', "gender","what_participant_group", "field_research","opinion_fundamental_important"))
canada<-important[important$Country_work=="Canada" | (!(important$Country_work=="Canada") & important$Country_work=="" & important$Country=="Canada"),]
change<-subset(research.change, select=c("Location","Country",'Country_work', "gender","what_participant_group", "field_research", "changed_10yrs"))
canada<-change[change$Country_work=="Canada" | (!(change$Country_work=="Canada") &
change$Country_work=="" & change$Country=="Canada"),]
head(canada)
canada<-canada[!canada$what_participant_group=="",]
canada<-canada[!canada$changed_10yrs=="",]
canada<-droplevels(canada)
## using table to count cases of each category
sum.change<-data.frame(table(canada$changed_10yrs, canada$field_research))
change.mod1<-(glm(Freq ~ Var1*Var2, sum.change, family="poisson"))
change.mod2<-(glm(Freq ~ Var1 +Var2, sum.change, family="poisson"))
visreg(change.mod1, "Var2",by="Var1", scale="response", ylab="Number of responses", xlab="Gender")
summary(change.mod1)
head(change.mod2)
anova(change.mod1, change.mod2, test="Chi")
important<-subset(part4, select=c("Location","Country",'Country_work', "gender","what_participant_group", "field_research","opinion_fundamental_important"))
canada<-important[important$Country_work=="Canada" | (!(important$Country_work=="Canada") & important$Country_work=="" & important$Country=="Canada"),]
head(canada)
canada<-canada[!canada$opinion_fundamental_important=="",]
head(canada)
canada$opinion_fundamental_important<-factor(canada$opinion_fundamental_important, levels(canada$opinion_fundamental_important)[c(6,5,4,3,2,1)])
canada<-droplevels(canada)
head(canada)
## using table to count cases of each category
sum.important<-data.frame(table(canada$opinion_fundamental_important, canada$field_research))
head(sum.important)
sum.important<-sum.important[!sum.important$Var2=="",]
head(sum.important)
temp<-with(canada, table(opinion_fundamental_important, field_research))
chisq.test(temp)
priority.mod1<-(glm(Freq ~ Var1*Var2, sum.important, family="poisson"))
priority.mod2<-(glm(Freq ~ Var1 +Var2, sum.important, family="poisson"))
visreg(priority.mod1, "Var2",by="Var1", scale="response", ylab="Number of responses", xlab="Field of Research")
summary(priority.mod1)
head(priority.mod2)
anova(priority.mod1, priority.mod2, test="Chi")
important<-subset(part4, select=c("Location","Country",'Country_work', "gender","what_participant_group","what_participant_group", "field_research", "field_research","opinion_fundamental_important"))
canada<-important[important$Country_work=="Canada" | (!(important$Country_work=="Canada") & important$Country_work=="" & important$Country=="Canada"),]
head(canada)
canada<-canada[!canada$opinion_fundamental_important=="",]
canada<-droplevels(canada)
head(canada)
priority<-subset(part4, select=c("Location","Country",'Country_work', "gender","what_participant_group",  "field_research", "high_priority_fundamental", "high_priority_use_inspired", "high_priority_applied",
"high_priority_no_change"))
canada<-priority[priority$Country_work=="Canada" | (!(priority$Country_work=="Canada") & priority$Country_work=="" & priority$Country=="Canada"),]
priority.long<-gather(canada, what.type, higher.priority, -Location, -gender, -Country, -Country_work, -what_participant_group,  -field_research)
priority.long<-priority.long[!is.na(priority.long$higher.priority),]
field.perceive<-data.frame(table( priority.long$field_research , priority.long$what.type))
priority.mod<-(glm(Freq ~ Var1*Var2, field.perceive, family="poisson"))
visreg(priority.mod, "Var2",by="Var1", scale="response", ylab="No. of responses (scaled by gender)", xlab="Field of Research")
priority.mod1<-(glm(Freq ~ Var1*Var2, field.perceive, family="poisson"))
priority.mod2<-(glm(Freq ~ Var1 +Var2, field.perceive, family="poisson"))
visreg(priority.mod1, "Var2",by="Var1", scale="response", ylab="Number of responses", xlab="Field of Research")
summary(priority.mod1)
anova(priority.mod1, priority.mod2, test="Chi")
availability.change<-subset(part4, select=c("Location", "Country",'Country_work', "gender","what_participant_group",  "field_research", "available_funding_fundamental",
"available_funding_use_inspired", "available_funding_applied"))
canada<-availability.change[availability.change$Country_work=="Canada" | (!(availability.change$Country_work=="Canada") & availability.change$Country_work=="" & availability.change$Country=="Canada"),]
availability.change.long.ca<-gather(canada, what.type, level, -gender, -Location, -Country, -Country_work, -what_participant_group,  -field_research)
availability.ca<-with(availability.change.long.ca, data.frame(table(what.type, level)))
#remove non response
availability.ca<-availability.ca[!availability.ca$level=="",]
availability.ca$level<-str_replace_all(availability.ca$level, "Will ", "")
availability.ca$what.type<-as.factor(availability.ca$what.type)
availability.ca$level<-as.factor(availability.ca$level)
## change order of levels
availability.ca$level<-factor(availability.ca$level, levels(availability.ca$level)[c(4,5,6,3,2,1 )])
availability.ca$what.type<-factor(availability.ca$what.type, levels(availability.ca$what.type)[c(2,3,1)])
availability.ca$what.type<-revalue(availability.ca$what.type, c("available_funding_fundamental"="Fundamental",
'available_funding_use_inspired'='Use-inspired', 'available_funding_applied' = 'Applied'))
next.generation<-subset(part4, select=c("Location", "Country","Country_work", "gender","what_participant_group",  "field_research","next_generation"))
# remove non-response
next.generation<-next.generation[!next.generation$next_generation=="",]
canada<-next.generation[next.generation$Country_work=="Canada" | (!(next.generation$Country_work=="Canada") & next.generation$Country_work=="" & next.generation$Country=="Canada"),]
impact<-data.frame(table(canada$next_generation))
change<-subset(research.change, select=c("Location","Country",'Country_work', "gender","what_participant_group",  "field_research", "changed_10yrs"))
canada<-change[change$Country_work=="Canada" | (!(change$Country_work=="Canada") &
change$Country_work=="" & change$Country=="Canada"),]
